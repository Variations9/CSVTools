<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Folder Tree to Spreadsheet Converter</title>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function FolderTreeConverter() {
          const [input, setInput] = useState('');
          const [output, setOutput] = useState([]);
          const [copySuccess, setCopySuccess] = useState(false);

          const parseTreeStructure = (text) => {
            const lines = text.split('\n');
            const result = [];
            const pathStack = [];
            
            for (let line of lines) {
              if (!line.trim() || line.trim() === '```') continue;
              
              const leadingSpaces = line.match(/^(\s*)/)[0].length;
              const depth = Math.floor(leadingSpaces / 4);
              
              let cleaned = line
                .replace(/^[\s│├└─]+/, '')
                .replace(/📁/g, '')
                .replace(/📄/g, '')
                .trim();
              
              if (!cleaned) continue;
              
              const isFile = cleaned.includes('.') && !cleaned.endsWith('/');
              let type;
              
              if (isFile) {
                const extMatch = cleaned.match(/\.([^.]+)$/);
                type = extMatch ? `.${extMatch[1]} file` : 'file';
              } else {
                type = 'folder';
              }
              
              pathStack[depth] = cleaned;
              pathStack.length = depth + 1;
              
              const fullPath = [...pathStack];
              
              result.push({
                path: fullPath,
                type: type,
                depth: depth,
                name: cleaned
              });
            }
            
            return result;
          };

          const handleConvert = () => {
            const parsed = parseTreeStructure(input);
            setOutput(parsed);
            setCopySuccess(false);
          };

          const generateTSV = () => {
            if (output.length === 0) return '';
            
            const maxDepth = Math.max(...output.map(item => item.path.length));
            
            const headers = Array.from({ length: maxDepth }, (_, i) => {
              if (i === 0) return 'Root Folder';
              return `Sub-Folder Level ${i + 1}`;
            });
            headers.push('Type');
            headers.push('Summary');
            
            let tsv = headers.join('\t') + '\n';
            
            output.forEach(item => {
              const paddedPath = [...item.path];
              while (paddedPath.length < maxDepth) {
                paddedPath.push('');
              }
              paddedPath.push(item.type);
              paddedPath.push('');
              tsv += paddedPath.join('\t') + '\n';
            });
            
            return tsv;
          };

          const copyToClipboard = async () => {
            const tsv = generateTSV();
            try {
              await navigator.clipboard.writeText(tsv);
              setCopySuccess(true);
              setTimeout(() => setCopySuccess(false), 2000);
            } catch (err) {
              alert('Failed to copy. Please try the download option.');
            }
          };

          const downloadCSV = () => {
            const tsv = generateTSV();
            const blob = new Blob([tsv], { type: 'text/tab-separated-values' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'folder-structure.tsv';
            a.click();
            URL.revokeObjectURL(url);
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
              <div className="max-w-6xl mx-auto">
                <div className="bg-white rounded-lg shadow-xl p-6 mb-6">
                  <div className="flex items-center gap-3 mb-4">
                    <svg className="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    <h1 className="text-3xl font-bold text-gray-800">Folder Tree to Spreadsheet Converter</h1>
                  </div>
                  <p className="text-gray-600 mb-6">
                    Paste your folder structure below and convert it to a hierarchical spreadsheet format.
                  </p>

                  <div className="grid md:grid-cols-2 gap-6">
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">
                        Input: Folder Tree Structure
                      </label>
                      <textarea
                        value={input}
                        onChange={(e) => setInput(e.target.value)}
                        placeholder="Paste your folder tree here...  Evan's Hint: In Visual Studio Code, install and use the extension called 'Draw Folder Structure' by Krivoox - v1.4.5. to use: select the /Source folder, right-click, and then select: 'Generate Markdown Structure' A new .md doc is created!  Simply Copy and Paste into here!  "
                        className="w-full h-96 p-4 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none font-mono text-sm"
                      />
                      <button
                        onClick={handleConvert}
                        className="mt-4 w-full bg-indigo-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-indigo-700 transition-colors"
                      >
                        Convert to Spreadsheet Format
                      </button>
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">
                        Output: Spreadsheet Data
                      </label>
                      <div className="border-2 border-gray-300 rounded-lg h-96 overflow-auto bg-gray-50 p-4">
                        {output.length === 0 ? (
                          <div className="flex items-center justify-center h-full text-gray-400">
                            Converted data will appear here
                          </div>
                        ) : (
                          <table className="w-full text-xs">
                            <thead>
                              <tr className="bg-indigo-100">
                                {Array.from({ length: Math.max(...output.map(item => item.path.length)) }, (_, i) => (
                                  <th key={i} className="p-2 text-left font-semibold border-b-2 border-indigo-200">
                                    {i === 0 ? 'Root Folder' : `Sub-Folder Level ${i + 1}`}
                                  </th>
                                ))}
                                <th className="p-2 text-center font-semibold border-b-2 border-indigo-200">Type</th>
                                <th className="p-2 text-left font-semibold border-b-2 border-indigo-200">Summary</th>
                              </tr>
                            </thead>
                            <tbody>
                              {output.map((item, idx) => {
                                const maxDepth = Math.max(...output.map(i => i.path.length));
                                const paddedPath = [...item.path];
                                while (paddedPath.length < maxDepth) {
                                  paddedPath.push('');
                                }
                                return (
                                  <tr key={idx} className="border-b border-gray-200 hover:bg-indigo-50">
                                    {paddedPath.map((cell, cellIdx) => (
                                      <td key={cellIdx} className="p-2 border-r border-gray-100">{cell}</td>
                                    ))}
                                    <td className="p-2 text-center border-r border-gray-100">
                                      <span className={`px-2 py-1 rounded text-xs ${
                                        item.type === 'folder' 
                                          ? 'bg-blue-100 text-blue-800' 
                                          : 'bg-green-100 text-green-800'
                                      }`}>
                                        {item.type}
                                      </span>
                                    </td>
                                    <td className="p-2 text-gray-400 italic">
                                    </td>
                                  </tr>
                                );
                              })}
                            </tbody>
                          </table>
                        )}
                      </div>
                      
                      {output.length > 0 && (
                        <div className="mt-4 flex gap-3">
                          <button
                            onClick={copyToClipboard}
                            className="flex-1 bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2"
                          >
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            </svg>
                            {copySuccess ? 'Copied!' : 'Copy to Clipboard'}
                          </button>
                          <button
                            onClick={downloadCSV}
                            className="flex-1 bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-2"
                          >
                            <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                            </svg>
                            Download TSV
                          </button>
                        </div>
                      )}
                      
                      {output.length > 0 && (
                        <div className="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                          <p className="text-sm text-blue-800 font-semibold mb-1">📋 How to use:</p>
                          <ol className="text-sm text-blue-700 space-y-1 ml-4 list-decimal">
                            <li>Click "Copy to Clipboard" above</li>
                            <li>Open Google Sheets and select cell A1</li>
                            <li>Press Ctrl+V (or Cmd+V on Mac) to paste</li>
                            <li>The data will automatically fill into columns</li>
                          </ol>
                        </div>
                      )}
                    </div>
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg p-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-3">Example Input</h2>
                  <pre className="bg-gray-100 p-4 rounded text-xs overflow-x-auto font-mono text-gray-700">
{`└── 📁Source
    ├── 📁css
    │   ├── add-button.css
    │   └── base.css
    └── 📁icons
        ├── dark@1x.png
        └── light@1x.png`}
                  </pre>
                </div>
              </div>
            </div>
          );
        }

        ReactDOM.render(<FolderTreeConverter />, document.getElementById('root'));
    </script>
</body>
</html>