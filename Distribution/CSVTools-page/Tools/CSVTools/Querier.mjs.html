<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatted Code - JavaScript</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background: #ffffff;
            padding: 3rem;
            color: #000000;
            line-height: 1.6;
            font-size: 12pt;
            font-weight: bold;
            font-style: normal;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
        }

        .code-container {
            background: #ffffff;
            padding: 0;
        }

        .code-line {
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-bottom: 0.1rem;
        }

        .comment {
            color: #228b22;
            font-size: 11pt;
            font-family: 'Bookman Old Style', serif;
            font-weight: normal;
            font-style: normal;
        }

        .keyword {
            color: #0000ff;
            font-weight: 600;
        }

        .string {
            color: #a31515;
        }

        .number {
            color: #098658;
        }

        .function {
            color: #795e26;
        }

        .operator {
            color: #000000;
        }

        .type {
            color: #267f99;
        }

        .variable {
            color: #001080;
        }

        @media print {
            body {
                padding: 1rem;
            }

            .code-container {
                border: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="code-container">
            <div class="code-line"><span class="comment">QUERIER - CSV QUERY ENGINE WITH PLUGGABLE TRAVERSERS</span></div>
            <div class="code-line"><span class="keyword">import</span><span class="operator"> </span><span class="variable">path</span><span class="operator"> </span><span class="keyword">from</span><span class="operator"> </span><span class="string">&#039;node:path&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">import</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">loadCsvTable</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">writeCsvTable</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">ensureColumns</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">createValueAccessor</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">buildRowPath</span><span class="operator"> </span><span class="variable">as</span><span class="operator"> </span><span class="variable">computeRowPath</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">}</span><span class="operator"> </span><span class="keyword">from</span><span class="operator"> </span><span class="string">&#039;./lib/table-helpers.mjs&#039;</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">CONFIGURATION CONSTANTS</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Required CSV columns for query processing These columns must exist in the CSV for the</span></div>
            <div class="code-line"><span class="comment">querier to function properly</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">REQUIRED_COLUMNS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;DEBUGGER QUERY&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Column Q: Contains user query input</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;QUERY RESULTS&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Column R: Stores query execution results</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;SAVED RESULT 1&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Column S: First saved result slot</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;SAVED RESULT 2&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Column T: Second saved result slot</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;SAVED RESULT 3&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Column U: Third saved result slot</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Traverser modules to load dynamically These modules implement different query strategies (</span></div>
            <div class="code-line"><span class="comment">feature-mode, linkage, structure-finder, etc.)</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">TRAVERSER_MODULES</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;./Querier1.mjs&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Feature-mode comparison traverser</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;./Querier2.mjs&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Linkage mapping traverser</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;./Querier3.mjs&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Structure-finder traverser</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;./traverserQuerier2.mjs&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator"> </span><span class="comment">Default row-summary traverser (fallback)</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">QUERY PARSING</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Parses a query cell value into a structured format</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Extracts query information from CSV cell, supporting both plain text and JSON</span></div>
            <div class="code-line"><span class="comment">queries</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Features: - Handles empty/null values gracefully - Attempts JSON parsing for structured</span></div>
            <div class="code-line"><span class="comment">queries (e.g., {&quot;type&quot;:&quot;linkage&quot;,&quot;target&quot;:&quot;n44&quot;}) - Tokenizes text for keyword matching -</span></div>
            <div class="code-line"><span class="comment">Provides multiple access patterns (raw, text, tokens, json)</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string|null|undefined} value - Raw cell value from CSV @returns {Object} Parsed</span></div>
            <div class="code-line"><span class="comment">query object with structure: - raw: Original unmodified value - text: Trimmed text content</span></div>
            <div class="code-line"><span class="comment">- tokens: Lowercase word array for matching - json: Parsed JSON object (if valid) or null</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">parseQueryCell</span><span class="operator">(</span><span class="variable">value</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">text</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="variable">value</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">text</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">raw</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="variable">text</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="variable">tokens</span><span class="operator">:</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">,</span><span class="operator"> </span><span class="variable">json</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">null</span><span class="operator"> </span><span class="operator">}</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Attempt JSON parsing for structured queries like {&quot;type&quot;:&quot;linkage&quot;,&quot;target&quot;:&quot;n44&quot;}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">json</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">text</span><span class="operator">.</span><span class="function">startsWith</span><span class="operator">(</span><span class="string">&#039;{&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="function">endsWith</span><span class="operator">(</span><span class="string">&#039;}&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">try</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">json</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="type">JSON</span><span class="operator">.</span><span class="function">parse</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">catch</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">json</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">raw</span><span class="operator">:</span><span class="operator"> </span><span class="variable">text</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">text</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">tokens</span><span class="operator">:</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="function">toLowerCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="function">split</span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">/</span><span class="operator">)</span><span class="operator">.</span><span class="function">filter</span><span class="operator">(</span><span class="type">Boolean</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">json</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">TRAVERSER LOADING</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Dynamically loads all query traverser modules</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Imports and validates traverser modules that implement different query strategies</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Delegation Pattern: Each traverser must export: - run(context): Function that executes the</span></div>
            <div class="code-line"><span class="comment">query and returns results - matches(context): Optional function to determine if traverser</span></div>
            <div class="code-line"><span class="comment">should handle query</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Validation: - Ensures each module exports a valid traverser with run() function - Adds</span></div>
            <div class="code-line"><span class="comment">default matches() function if not provided (always returns true) - Throws error if module</span></div>
            <div class="code-line"><span class="comment">structure is invalid</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@returns {Promise&lt;Array&gt;} Array of loaded traverser modules @throws {Error} If any</span></div>
            <div class="code-line"><span class="comment">traverser module is invalid or fails to load</span></div>
            <div class="code-line"><span class="keyword">async</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">loadTraversers</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">modules</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="type">Promise</span><span class="operator">.</span><span class="function">all</span><span class="operator">(</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="type">TRAVERSER_MODULES</span><span class="operator">.</span><span class="function">map</span><span class="operator">(</span><span class="keyword">async</span><span class="operator"> </span><span class="operator">(</span><span class="variable">modulePath</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">url</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">URL</span><span class="operator">(</span><span class="variable">modulePath</span><span class="operator">,</span><span class="operator"> </span><span class="keyword">import</span><span class="operator">.</span><span class="variable">meta</span><span class="operator">.</span><span class="variable">url</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">mod</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="keyword">import</span><span class="operator">(</span><span class="variable">url</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">traverser</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">mod</span><span class="operator">.</span><span class="keyword">default</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="variable">mod</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Validate traverser structure - must have run() function</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">traverser</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="keyword">typeof</span><span class="operator"> </span><span class="variable">traverser</span><span class="operator">.</span><span class="variable">run</span><span class="operator"> </span><span class="operator">!</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;function&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">throw</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Error</span><span class="operator">(</span><span class="string">`Traverser ${modulePath} does not export a run() function.`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Add default matches() function if not provided (accepts all queries)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="keyword">typeof</span><span class="operator"> </span><span class="variable">traverser</span><span class="operator">.</span><span class="variable">matches</span><span class="operator"> </span><span class="operator">!</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;function&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">traverser</span><span class="operator">.</span><span class="variable">matches</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="keyword">true</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">traverser</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">modules</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">MAIN QUERY PROCESSING ENGINE</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Main query processing workflow</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Orchestrates the entire query execution pipeline from CSV load to result storage</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Workflow Steps: 1. Load CSV table and validate structure 2. Ensure required columns exist (</span></div>
            <div class="code-line"><span class="comment">creates if missing) 3. Load all traverser modules 4. Process each row with a query: -</span></div>
            <div class="code-line"><span class="comment">Parse the query cell - Build query context with row data and helper functions - Select</span></div>
            <div class="code-line"><span class="comment">appropriate traverser via matches() function - Execute traverser.run() to generate results</span></div>
            <div class="code-line"><span class="comment">- Store results in QUERY RESULTS column 5. Write updated CSV with results</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Features: - Skips rows without queries - Provides rich context to traversers (row data,</span></div>
            <div class="code-line"><span class="comment">helpers, indices) - Handles traverser errors gracefully with error messages in results -</span></div>
            <div class="code-line"><span class="comment">Tracks processing statistics (processed count, updated count) - Logs progress with</span></div>
            <div class="code-line"><span class="comment">traverser identification</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Context Object Structure: - query: Parsed query object (from parseQueryCell) - row:</span></div>
            <div class="code-line"><span class="comment">Current CSV row data array - rowIndex: Zero-based row index - rows: Complete CSV data</span></div>
            <div class="code-line"><span class="comment">array - headers: CSV header row - typeIndex: Index of TYPE column - getPath(): Function to</span></div>
            <div class="code-line"><span class="comment">build file path for current row - buildRowPath(targetRow): Function to build file path for</span></div>
            <div class="code-line"><span class="comment">any row - getValue: Function to access column values by header name</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@returns {Promise&lt;void&gt;} @throws {Error} If CSV structure is invalid or processing fails</span></div>
            <div class="code-line"><span class="keyword">async</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">main</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;============================================================&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;CSV Traverser / Querier (Column Q â†’ Column R)&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;============================================================\n&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Load CSV table and get structure</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">csvPath</span><span class="operator">,</span><span class="operator"> </span><span class="variable">headers</span><span class="operator">,</span><span class="operator"> </span><span class="variable">rows</span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="function">loadCsvTable</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Ensure all required columns exist (creates them if missing)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">columnIndices</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">ensureColumns</span><span class="operator">(</span><span class="variable">headers</span><span class="operator">,</span><span class="operator"> </span><span class="variable">rows</span><span class="operator">,</span><span class="operator"> </span><span class="type">REQUIRED_COLUMNS</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Find TYPE column index (required for path construction)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">typeIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">headers</span><span class="operator">.</span><span class="function">findIndex</span><span class="operator">(</span><span class="operator">(</span><span class="variable">header</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">header</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="function">toUpperCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;TYPE&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">typeIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">throw</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Error</span><span class="operator">(</span><span class="string">&#039;Unable to locate &quot;Type&quot; column in CSV header.&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Create value accessor helper function for easy column access by name</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">getValue</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">createValueAccessor</span><span class="operator">(</span><span class="variable">headers</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Load all traverser modules dynamically</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">traversers</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="function">loadTraversers</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">processed</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">updated</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Process each row in the CSV</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">for</span><span class="operator"> </span><span class="operator">(</span><span class="keyword">let</span><span class="operator"> </span><span class="variable">rowIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span><span class="operator"> </span><span class="variable">rowIndex</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">rows</span><span class="operator">.</span><span class="variable">length</span><span class="operator">;</span><span class="operator"> </span><span class="variable">rowIndex</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">row</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">rows</span><span class="operator">[</span><span class="variable">rowIndex</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">queryCell</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="variable">row</span><span class="operator">[</span><span class="variable">columnIndices</span><span class="operator">[</span><span class="string">&#039;DEBUGGER QUERY&#039;</span><span class="operator">]</span><span class="operator">]</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Skip rows without queries</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">queryCell</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">processed</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Parse the query into structured format (text, tokens, JSON)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">parsedQuery</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">parseQueryCell</span><span class="operator">(</span><span class="variable">queryCell</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Build comprehensive context object for traversers</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">This provides all data and helper functions needed for query execution</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">context</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">query</span><span class="operator">:</span><span class="operator"> </span><span class="variable">parsedQuery</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">row</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">rowIndex</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">rows</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">headers</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">typeIndex</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">getPath</span><span class="operator">:</span><span class="operator"> </span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="function">computeRowPath</span><span class="operator">(</span><span class="variable">row</span><span class="operator">,</span><span class="operator"> </span><span class="variable">typeIndex</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">buildRowPath</span><span class="operator">:</span><span class="operator"> </span><span class="operator">(</span><span class="variable">targetRow</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="function">computeRowPath</span><span class="operator">(</span><span class="variable">targetRow</span><span class="operator">,</span><span class="operator"> </span><span class="variable">typeIndex</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">getValue</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Select appropriate traverser using matches() function</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Falls back to last traverser (default row-summary) if no specific match</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">traverser</span><span class="operator"> </span><span class="operator">=</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">traversers</span><span class="operator">.</span><span class="function">find</span><span class="operator">(</span><span class="operator">(</span><span class="variable">candidate</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">try</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">candidate</span><span class="operator">.</span><span class="function">matches</span><span class="operator">(</span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">.</span><span class="operator">.</span><span class="operator">.</span><span class="variable">context</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">query</span><span class="operator">:</span><span class="operator"> </span><span class="variable">parsedQuery</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">catch</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="keyword">false</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="variable">traversers</span><span class="operator">[</span><span class="variable">traversers</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">-</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Execute traverser and capture results</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">try</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="variable">traverser</span><span class="operator">.</span><span class="function">run</span><span class="operator">(</span><span class="variable">context</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">catch</span><span class="operator"> </span><span class="operator">(</span><span class="variable">error</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Store error message in results for debugging</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="string">`Querier error (${traverser.id ?? &#039;unknown&#039;}): ${error.message}`</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Store trimmed result in QUERY RESULTS column</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">trimmedResult</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="variable">result</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">toString</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">row</span><span class="operator">[</span><span class="variable">columnIndices</span><span class="operator">[</span><span class="string">&#039;QUERY RESULTS&#039;</span><span class="operator">]</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">trimmedResult</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">updated</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="string">`Processed query @ row ${rowIndex + 2} via ${</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">traverser</span><span class="operator">.</span><span class="variable">id</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">basename</span><span class="operator">(</span><span class="variable">traverser</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">`</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">/</span><span class="operator">/</span><span class="operator"> </span><span class="type">Write</span><span class="operator"> </span><span class="variable">updated</span><span class="operator"> </span><span class="type">CSV</span><span class="operator"> </span><span class="variable">back</span><span class="operator"> </span><span class="variable">to</span><span class="operator"> </span><span class="variable">disk</span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="variable">changes</span><span class="operator"> </span><span class="variable">were</span><span class="operator"> </span><span class="variable">made</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">updated</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="function">writeCsvTable</span><span class="operator">(</span><span class="variable">csvPath</span><span class="operator">,</span><span class="operator"> </span><span class="variable">headers</span><span class="operator">,</span><span class="operator"> </span><span class="variable">rows</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">`\nUpdated ${updated} row(s) in ${path.relative(process.cwd(), csvPath)}.`</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="operator">&#039;</span><span class="operator">\</span><span class="variable">nNo</span><span class="operator"> </span><span class="variable">queries</span><span class="operator"> </span><span class="variable">found</span><span class="operator">;</span><span class="operator"> </span><span class="variable">nothing</span><span class="operator"> </span><span class="variable">to</span><span class="operator"> </span><span class="variable">update</span><span class="operator">.</span><span class="operator">&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="operator">`</span><span class="type">Querier</span><span class="operator"> </span><span class="variable">complete</span><span class="operator">.</span><span class="operator"> </span><span class="type">Queries</span><span class="operator"> </span><span class="variable">evaluated</span><span class="operator">:</span><span class="operator"> </span><span class="operator">$</span><span class="operator">{</span><span class="variable">processed</span><span class="operator">}</span><span class="operator">.</span><span class="operator">`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator">/</span><span class="operator">/</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></div>
            <div class="code-line"><span class="operator">/</span><span class="operator">/</span><span class="operator"> </span><span class="type">EXECUTION</span></div>
            <div class="code-line"><span class="operator">/</span><span class="operator">/</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator">/</span><span class="operator">/</span><span class="operator"> </span><span class="type">Execute</span><span class="operator"> </span><span class="variable">main</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="variable">and</span><span class="operator"> </span><span class="variable">handle</span><span class="operator"> </span><span class="variable">any</span><span class="operator"> </span><span class="variable">fatal</span><span class="operator"> </span><span class="variable">errors</span></div>
            <div class="code-line"><span class="function">main</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="keyword">catch</span><span class="operator">(</span><span class="operator">(</span><span class="variable">error</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">error</span><span class="operator">(</span><span class="operator">&#039;</span><span class="type">Querier</span><span class="operator"> </span><span class="variable">failed</span><span class="operator">:</span><span class="operator">&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="variable">error</span><span class="operator">.</span><span class="variable">message</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="function">exit</span><span class="operator">(</span><span class="number">1</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
        </div>
    </div>
</body>
</html>