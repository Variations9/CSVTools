<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatted Code - JavaScript</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background: #ffffff;
            padding: 3rem;
            color: #000000;
            line-height: 1.6;
            font-size: 12pt;
            font-weight: bold;
            font-style: normal;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
        }

        .code-container {
            background: #ffffff;
            padding: 0;
        }

        .code-line {
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-bottom: 0.1rem;
        }

        .comment {
            color: #228b22;
            font-size: 11pt;
            font-family: 'Bookman Old Style', serif;
            font-weight: normal;
            font-style: normal;
        }

        .keyword {
            color: #0000ff;
            font-weight: 600;
        }

        .string {
            color: #a31515;
        }

        .number {
            color: #098658;
        }

        .function {
            color: #795e26;
        }

        .operator {
            color: #000000;
        }

        .type {
            color: #267f99;
        }

        .variable {
            color: #001080;
        }

        @media print {
            body {
                padding: 1rem;
            }

            .code-container {
                border: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="code-container">
            <div class="code-line"><span class="comment">C# ANALYSIS - Static code analysis utilities for C# source files</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">SECTION 1: PATTERN DEFINITIONS - Keywords and API Patterns</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Control flow keywords that should be ignored when identifying method calls These are</span></div>
            <div class="code-line"><span class="comment">language constructs, not actual method invocations</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">SKIP_CALL_NAMES</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;if&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;else&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;for&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;foreach&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;while&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;switch&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;case&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;default&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;do&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;try&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;catch&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;finally&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;using&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;lock&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;checked&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;unchecked&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;fixed&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;typeof&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;nameof&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;sizeof&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;new&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">File system read operations from System.IO namespace Used to detect file input operations</span></div>
            <div class="code-line"><span class="comment">in code</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">FILE_READ_CALLS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.ReadAllText&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.ReadAllLines&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.ReadAllBytes&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.OpenRead&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.OpenText&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.Exists&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;FileInfo.OpenRead&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;FileStream.Read&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Directory.GetFiles&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Directory.GetDirectories&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Directory.EnumerateFiles&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Directory.EnumerateDirectories&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Directory.Exists&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">File system write operations from System.IO namespace Used to detect file output and</span></div>
            <div class="code-line"><span class="comment">modification operations</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">FILE_WRITE_CALLS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.WriteAllText&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.WriteAllLines&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.WriteAllBytes&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.AppendAllText&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.AppendAllLines&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.AppendText&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.OpenWrite&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.Create&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.CreateText&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.Copy&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.Move&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;File.Delete&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;FileStream.Write&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Directory.CreateDirectory&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Directory.Delete&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Directory.Move&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Console input methods that indicate user interaction</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">CONSOLE_INPUT_CALLS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="string">&#039;Console.ReadLine&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;Console.ReadKey&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;Console.Read&#039;</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Logging and console output methods Used to detect log emission and console output</span></div>
            <div class="code-line"><span class="comment">operations</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">LOG_CALLS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Console.WriteLine&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Console.Write&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Console.Error.WriteLine&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Console.Error.Write&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Debug.WriteLine&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Debug.Write&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Trace.WriteLine&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;Trace.Write&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Legacy WebClient read operations (pre-HttpClient)</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">WEBCLIENT_READ_CALLS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;WebClient.DownloadString&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;WebClient.DownloadData&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;WebClient.OpenRead&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Legacy WebClient write operations (pre-HttpClient)</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">WEBCLIENT_WRITE_CALLS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;WebClient.UploadString&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;WebClient.UploadData&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;WebClient.UploadValues&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Legacy HttpWebRequest operations</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">HTTP_WEB_REQUEST_CALLS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="string">&#039;HttpWebRequest.Create&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;HttpWebRequest.GetResponse&#039;</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Regex patterns for modern logging frameworks Each pattern has a regex and a label for</span></div>
            <div class="code-line"><span class="comment">categorization</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">LOGGER_REGEXES</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">regex</span><span class="operator">:</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">bILogger</span><span class="operator">\</span><span class="variable">w</span><span class="operator">*</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">.</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="function">Log</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="type">Trace</span><span class="operator">|</span><span class="type">Debug</span><span class="operator">|</span><span class="type">Information</span><span class="operator">|</span><span class="type">Warning</span><span class="operator">|</span><span class="type">Error</span><span class="operator">|</span><span class="type">Critical</span><span class="operator">)</span><span class="operator">?</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">/</span><span class="variable">g</span><span class="operator">,</span><span class="operator"> </span><span class="variable">label</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;ILogger.Log&#039;</span><span class="operator"> </span><span class="operator">}</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">regex</span><span class="operator">:</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">blogger</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">.</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="function">Log</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="type">Trace</span><span class="operator">|</span><span class="type">Debug</span><span class="operator">|</span><span class="type">Information</span><span class="operator">|</span><span class="type">Warning</span><span class="operator">|</span><span class="type">Error</span><span class="operator">|</span><span class="type">Critical</span><span class="operator">)</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="variable">gi</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">label</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;ILogger.Log&#039;</span><span class="operator"> </span><span class="operator">}</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Regex patterns for configuration access patterns Detects environment variables,</span></div>
            <div class="code-line"><span class="comment">ConfigurationManager, IConfiguration, and IOptions</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">CONFIG_REGEXES</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">regex</span><span class="operator">:</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">bEnvironment</span><span class="operator">\</span><span class="operator">.</span><span class="type">GetEnvironmentVariable</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="variable">g</span><span class="operator">,</span><span class="operator"> </span><span class="variable">label</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;Environment.</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="type">GetEnvironmentVariable</span><span class="string">&#039; },</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">regex</span><span class="operator">:</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">bConfigurationManager</span><span class="operator">\</span><span class="operator">.</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">/</span><span class="variable">g</span><span class="operator">,</span><span class="operator"> </span><span class="variable">label</span><span class="operator">:</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;ConfigurationManager&#039;</span><span class="operator"> </span><span class="operator">}</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">regex</span><span class="operator">:</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">bIConfiguration</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">[</span><span class="operator">/</span><span class="variable">g</span><span class="operator">,</span><span class="operator"> </span><span class="variable">label</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;IConfiguration[indexer]&#039;</span><span class="operator"> </span><span class="operator">}</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">regex</span><span class="operator">:</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="function">bIOptions</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="type">Monitor</span><span class="operator">|</span><span class="type">Snapshot</span><span class="operator">)</span><span class="operator">?</span><span class="operator">&lt;</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">&lt;</span><span class="operator">&gt;</span><span class="operator">,</span><span class="operator">\</span><span class="variable">s</span><span class="operator">]</span><span class="operator">*</span><span class="operator">&gt;</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">.</span><span class="operator">/</span><span class="variable">g</span><span class="operator">,</span><span class="operator"> </span><span class="variable">label</span><span class="operator">:</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;IOptions&#039;</span><span class="operator"> </span><span class="operator">}</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Pattern to detect static field declarations Captures field name from static field</span></div>
            <div class="code-line"><span class="comment">declarations (with or without readonly)</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">STATIC_FIELD_REGEX</span><span class="operator"> </span><span class="operator">=</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">bstatic</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="variable">readonly</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">)</span><span class="operator">?</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">&lt;</span><span class="operator">&gt;</span><span class="operator">,</span><span class="operator">\</span><span class="operator">[</span><span class="operator">\</span><span class="operator">]</span><span class="operator">\</span><span class="variable">s</span><span class="operator">?</span><span class="operator">]</span><span class="operator">*</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">(</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="operator">=</span><span class="operator">|</span><span class="operator">;</span><span class="operator">)</span><span class="operator">/</span><span class="variable">g</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Pattern to detect event subscriptions using += operator Captures the event name being</span></div>
            <div class="code-line"><span class="comment">subscribed to</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">EVENT_SUBSCRIPTION_REGEX</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">/</span><span class="operator">(</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">\</span><span class="operator">.</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">)</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">+</span><span class="operator">=</span><span class="operator">/</span><span class="variable">g</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 2: CODE SANITIZATION</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Removes comments and optionally string literals from C# code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Prepares code for analysis by removing non-executable content that could</span></div>
            <div class="code-line"><span class="comment">interfere with pattern matching.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Features: - Removes single-line comments (//) - Removes multi-line comments (slash-star ...</span></div>
            <div class="code-line"><span class="comment">star-slash) while preserving line breaks - Handles string literals (both regular and</span></div>
            <div class="code-line"><span class="comment">verbatim @&quot;&quot; strings) - Handles escape sequences in strings - Optionally removes string</span></div>
            <div class="code-line"><span class="comment">content (replaced with spaces to preserve structure) - Preserves line breaks for accurate</span></div>
            <div class="code-line"><span class="comment">line-based analysis</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">String handling: - Regular strings: &quot;text&quot; - Verbatim strings: @&quot;text&quot; or $@&quot;text&quot; or</span></div>
            <div class="code-line"><span class="comment">@$&quot;text&quot; - Handles escaped quotes in verbatim strings (&quot;&quot;) - Handles escape sequences in</span></div>
            <div class="code-line"><span class="comment">regular strings (\n, \&quot;, etc.)</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} code - C# source code to sanitize @param {object} [options={}] -</span></div>
            <div class="code-line"><span class="comment">Configuration options @param {boolean} [options.removeStrings=false] - If true, replace</span></div>
            <div class="code-line"><span class="comment">string contents with spaces @returns {string} Sanitized code with comments removed</span></div>
            <div class="code-line"><span class="keyword">export</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">sanitizeCSharpCode</span><span class="operator">(</span><span class="variable">code</span><span class="operator">,</span><span class="operator"> </span><span class="variable">options</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">{</span><span class="operator">}</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">removeStrings</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">false</span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">options</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="keyword">typeof</span><span class="operator"> </span><span class="variable">code</span><span class="operator"> </span><span class="operator">!</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;string&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">code</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">length</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">code</span><span class="operator">.</span><span class="variable">length</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">inString</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">false</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">stringChar</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">inVerbatim</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">false</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="variable">i</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">length</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">next</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">inString</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Handle single-line comment</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;/&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">next</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;/&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">2</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="variable">i</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">length</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator"> </span><span class="operator">!</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\n&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator"> </span><span class="operator">!</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\r&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Handle multi-line comment</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;/&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">next</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;*&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">2</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="variable">i</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">length</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="operator">!</span><span class="operator">(</span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;*&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;/&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Preserve line breaks in result</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\n&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\r&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\r&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\n&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\n&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">2</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Detect start of string literal</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&quot;&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&quot;&#039;&quot;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">inString</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">true</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">stringChar</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">char</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">prev1</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">-</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">prev2</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">-</span><span class="operator"> </span><span class="number">2</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Detect verbatim string: @&quot;&quot;, $@&quot;&quot;, or @$&quot;&quot;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">inVerbatim</span><span class="operator"> </span><span class="operator">=</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&quot;&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">(</span><span class="variable">prev1</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;@&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="operator">(</span><span class="variable">prev1</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;$&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">prev2</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;@&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="operator">(</span><span class="variable">prev1</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;@&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">prev2</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;$&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">removeStrings</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\n&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\r&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="variable">char</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039; &#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="variable">char</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="variable">char</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Inside a string literal</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">removeStrings</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="variable">char</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\n&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\r&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="variable">char</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039; &#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Handle verbatim string escape sequence (doubled quotes)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">inVerbatim</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&quot;&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&quot;&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">removeStrings</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&quot;&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039; &#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">2</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">End of verbatim string</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;&quot;&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">inString</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">false</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">inVerbatim</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">false</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Handle escape sequences in regular strings</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\\&#039;</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">length</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">removeStrings</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\n&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;\r&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="variable">code</span><span class="operator">[</span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">result</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039; &#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">2</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">End of regular string</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="variable">stringChar</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">inString</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">false</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">inVerbatim</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">false</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">result</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 3: METHOD EXTRACTION</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Extracts all method names defined in C# code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Identifies method declarations (not calls) for understanding code structure and</span></div>
            <div class="code-line"><span class="comment">available functions.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Process: 1. Sanitizes code to remove comments and strings 2. Identifies</span></div>
            <div class="code-line"><span class="comment">class/struct/record names (for constructor detection) 3. Processes code line-by-line to</span></div>
            <div class="code-line"><span class="comment">avoid catastrophic regex backtracking 4. Matches method declaration patterns with</span></div>
            <div class="code-line"><span class="comment">modifiers 5. Validates declarations by checking for opening brace or =&gt; arrow 6.</span></div>
            <div class="code-line"><span class="comment">Identifies constructors by matching class names</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Detection logic: - Looks for access modifiers (public, private, etc.) - Matches return</span></div>
            <div class="code-line"><span class="comment">type and method name - Handles generic methods with type parameters - Distinguishes</span></div>
            <div class="code-line"><span class="comment">declarations from calls by checking for { or =&gt; - Skips control flow keywords that look</span></div>
            <div class="code-line"><span class="comment">like method syntax</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Performance: - Processes line-by-line (max 500 chars per line) to prevent regex hangs -</span></div>
            <div class="code-line"><span class="comment">Uses helper function to avoid deep recursion - Safety limits on parenthesis matching depth</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} code - C# source code to analyze @returns {string[]} Sorted array of</span></div>
            <div class="code-line"><span class="comment">method names found in code</span></div>
            <div class="code-line"><span class="keyword">export</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">extractCSharpMethodNames</span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">sanitizeCSharpCode</span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">methodNames</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">First pass: identify all class/struct/record names for constructor detection</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">classNames</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">classRegex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="function">b</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="keyword">class</span><span class="operator">|</span><span class="variable">struct</span><span class="operator">|</span><span class="variable">record</span><span class="operator">)</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">(</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">)</span><span class="operator">/</span><span class="variable">g</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">classMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="operator">(</span><span class="variable">classMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">classRegex</span><span class="operator">.</span><span class="function">exec</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">classNames</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="variable">classMatch</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Second pass: find method declarations line by line to avoid catastrophic backtracking</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">lines</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator">.</span><span class="function">split</span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="variable">r</span><span class="operator">?</span><span class="operator">\</span><span class="variable">n</span><span class="operator">/</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">for</span><span class="operator"> </span><span class="operator">(</span><span class="keyword">const</span><span class="operator"> </span><span class="variable">line</span><span class="operator"> </span><span class="keyword">of</span><span class="operator"> </span><span class="variable">lines</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Skip very long lines that might cause issues (likely not method declarations)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">line</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator"> </span><span class="number">500</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Pattern matches: [modifiers] ReturnType MethodName(...) { or =&gt;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">methodPattern</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="function">b</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="variable">public</span><span class="operator">|</span><span class="variable">protected</span><span class="operator">|</span><span class="variable">internal</span><span class="operator">|</span><span class="variable">private</span><span class="operator">|</span><span class="variable">static</span><span class="operator">|</span><span class="variable">virtual</span><span class="operator">|</span><span class="variable">override</span><span class="operator">|</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">sealed</span><span class="operator">|</span><span class="keyword">async</span><span class="operator">|</span><span class="variable">partial</span><span class="operator">|</span><span class="variable">extern</span><span class="operator">|</span><span class="variable">unsafe</span><span class="operator">|</span><span class="keyword">new</span><span class="operator">)</span><span class="operator">\</span><span class="variable">b</span><span class="operator">[</span><span class="operator">\</span><span class="variable">s</span><span class="operator">\</span><span class="variable">w</span><span class="operator">&lt;</span><span class="operator">&gt;</span><span class="operator">,</span><span class="operator">\</span><span class="operator">[</span><span class="operator">\</span><span class="operator">]</span><span class="operator">]</span><span class="operator">*</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">(</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">)</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">(</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">?</span><span class="operator">:</span><span class="operator">&lt;</span><span class="operator">[</span><span class="operator">^</span><span class="operator">&gt;</span><span class="operator">]</span><span class="operator">{</span><span class="number">0</span><span class="operator">,</span><span class="number">100</span><span class="operator">}</span><span class="operator">&gt;</span><span class="operator">)</span><span class="operator">?</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="variable">g</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">methodMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="operator">(</span><span class="variable">methodMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">methodPattern</span><span class="operator">.</span><span class="function">exec</span><span class="operator">(</span><span class="variable">line</span><span class="operator">)</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">candidateName</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">methodMatch</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Skip control flow keywords</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="type">SKIP_CALL_NAMES</span><span class="operator">.</span><span class="function">has</span><span class="operator">(</span><span class="variable">candidateName</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Check if the line looks like a method declaration (not a call)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">afterMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">line</span><span class="operator">.</span><span class="function">substring</span><span class="operator">(</span><span class="variable">methodMatch</span><span class="operator">.</span><span class="variable">index</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="variable">methodMatch</span><span class="operator">[</span><span class="number">0</span><span class="operator">]</span><span class="operator">.</span><span class="variable">length</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Look for closing paren and then { or =&gt;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">closingParenIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">findSimpleClosingParen</span><span class="operator">(</span><span class="variable">afterMatch</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">closingParenIndex</span><span class="operator"> </span><span class="operator">!</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">afterParen</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">afterMatch</span><span class="operator">.</span><span class="function">substring</span><span class="operator">(</span><span class="variable">closingParenIndex</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">afterParen</span><span class="operator">.</span><span class="function">startsWith</span><span class="operator">(</span><span class="string">&#039;{&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">afterParen</span><span class="operator">.</span><span class="function">startsWith</span><span class="operator">(</span><span class="string">&#039;=&gt;&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">methodNames</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="variable">candidateName</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Third pass: look for constructors (match class names)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">constructorPattern</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="function">b</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="variable">public</span><span class="operator">|</span><span class="variable">protected</span><span class="operator">|</span><span class="variable">internal</span><span class="operator">|</span><span class="variable">private</span><span class="operator">)</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">(</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">)</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="variable">g</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">ctorMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="operator">(</span><span class="variable">ctorMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">constructorPattern</span><span class="operator">.</span><span class="function">exec</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">name</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">ctorMatch</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">classNames</span><span class="operator">.</span><span class="function">has</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">methodNames</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="type">Array</span><span class="operator">.</span><span class="keyword">from</span><span class="operator">(</span><span class="variable">methodNames</span><span class="operator">)</span><span class="operator">.</span><span class="function">sort</span><span class="operator">(</span><span class="operator">(</span><span class="variable">a</span><span class="operator">,</span><span class="operator"> </span><span class="variable">b</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">a</span><span class="operator">.</span><span class="function">localeCompare</span><span class="operator">(</span><span class="variable">b</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Helper: Finds the matching closing parenthesis with depth limiting.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Safely locates closing paren without complex recursion.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Features: - Tracks nesting depth of parentheses - Limits maximum nesting depth to prevent</span></div>
            <div class="code-line"><span class="comment">issues with malformed code - Limits search distance to prevent infinite loops - Returns -1</span></div>
            <div class="code-line"><span class="comment">if no valid closing paren found</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Safety limits: - maxDepth: 5 (prevents deeply nested structures) - search range: 200</span></div>
            <div class="code-line"><span class="comment">characters (prevents scanning entire files)</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} text - Text to search (after opening paren) @param {number} [maxDepth=5] -</span></div>
            <div class="code-line"><span class="comment">Maximum nesting depth allowed @returns {number} Index of closing paren, or -1 if not</span></div>
            <div class="code-line"><span class="comment">found/too deep</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">findSimpleClosingParen</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="variable">maxDepth</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">5</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">depth</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span><span class="operator"> </span><span class="comment">Start at 1 since we&#039;re after the opening paren</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="variable">i</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="number">200</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="comment">Limit search to prevent hangs</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">text</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;(&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">depth</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">depth</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">maxDepth</span><span class="operator">)</span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator">;</span><span class="operator"> </span><span class="comment">Too deeply nested</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;)&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">depth</span><span class="operator"> </span><span class="operator">-</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">depth</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">i</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 4: CALL ORDER EXTRACTION</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Extracts the sequence of method/function calls from C# code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Captures the order of function invocations for control flow and dependency</span></div>
            <div class="code-line"><span class="comment">analysis.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Process: 1. Sanitizes code with strings removed (prevents false matches in literals) 2.</span></div>
            <div class="code-line"><span class="comment">Matches all patterns that look like method calls: Name(...) 3. Filters out control flow</span></div>
            <div class="code-line"><span class="comment">keywords and property accessors 4. Validates that calls are not actually method</span></div>
            <div class="code-line"><span class="comment">declarations 5. Returns calls in the order they appear in source</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Filtering logic: - Skips control flow keywords (if, for, while, etc.) - Skips method</span></div>
            <div class="code-line"><span class="comment">declarations (detected by {, =&gt;, or &#039;where&#039; clause) - Skips indexer access (preceded by &#039;[</span></div>
            <div class="code-line"><span class="comment">&#039;) - Handles qualified names (Class.Method, obj.Method) - Limits name segments to prevent</span></div>
            <div class="code-line"><span class="comment">runaway matching</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Performance: - Limits to 10,000 iterations to prevent infinite loops - Limits name</span></div>
            <div class="code-line"><span class="comment">segments to 5 (prevents excessive backtracking) - Limits generic type parameters to 100</span></div>
            <div class="code-line"><span class="comment">chars</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} code - C# source code to analyze @returns {string[]} Array of method call</span></div>
            <div class="code-line"><span class="comment">names in order of appearance</span></div>
            <div class="code-line"><span class="keyword">export</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">extractCSharpCallOrder</span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">sanitizeCSharpCode</span><span class="operator">(</span><span class="variable">code</span><span class="operator">,</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">removeStrings</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">true</span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">calls</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Pattern matches: Name(...) or Qualified.Name(...) with optional generics</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">callRegex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">/</span><span class="operator">(</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="operator">\</span><span class="operator">.</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">)</span><span class="operator">{</span><span class="number">0</span><span class="operator">,</span><span class="number">5</span><span class="operator">}</span><span class="operator">)</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="operator">&lt;</span><span class="operator">[</span><span class="operator">^</span><span class="operator">&gt;</span><span class="operator">]</span><span class="operator">{</span><span class="number">0</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="number">100</span><span class="operator">}</span><span class="operator">&gt;</span><span class="operator">)</span><span class="operator">?</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="variable">g</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">match</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">10000</span><span class="operator">;</span><span class="operator"> </span><span class="comment">Safety limit</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="operator">(</span><span class="variable">match</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">callRegex</span><span class="operator">.</span><span class="function">exec</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">iterations</span><span class="operator">+</span><span class="operator">+</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">fullName</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">match</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">lastSegment</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">fullName</span><span class="operator">.</span><span class="function">split</span><span class="operator">(</span><span class="string">&#039;.&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">pop</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Skip control flow keywords</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">lastSegment</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="type">SKIP_CALL_NAMES</span><span class="operator">.</span><span class="function">has</span><span class="operator">(</span><span class="variable">lastSegment</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Find the closing parenthesis of the call</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">openIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">callRegex</span><span class="operator">.</span><span class="variable">lastIndex</span><span class="operator"> </span><span class="operator">-</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">closeIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">findClosingParen</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">,</span><span class="operator"> </span><span class="variable">openIndex</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">closeIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Check what follows the closing paren to distinguish calls from declarations</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">afterIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">skipWhitespace</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">,</span><span class="operator"> </span><span class="variable">closeIndex</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">1</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">afterIndex</span><span class="operator"> </span><span class="operator">!</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">nextChar</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator">[</span><span class="variable">afterIndex</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">nextTwo</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator">.</span><span class="function">slice</span><span class="operator">(</span><span class="variable">afterIndex</span><span class="operator">,</span><span class="operator"> </span><span class="variable">afterIndex</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">2</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">nextFive</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator">.</span><span class="function">slice</span><span class="operator">(</span><span class="variable">afterIndex</span><span class="operator">,</span><span class="operator"> </span><span class="variable">afterIndex</span><span class="operator"> </span><span class="operator">+</span><span class="operator"> </span><span class="number">5</span><span class="operator">)</span><span class="operator">.</span><span class="function">toLowerCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Skip if this is a method declaration (followed by {, =&gt;, or &#039;where&#039;)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">nextChar</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;{&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">nextTwo</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;=&gt;&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">nextFive</span><span class="operator">.</span><span class="function">startsWith</span><span class="operator">(</span><span class="string">&#039;where&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Skip if this is an indexer access (preceded by &#039;[&#039;)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">beforeIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">skipWhitespaceBackward</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">,</span><span class="operator"> </span><span class="variable">match</span><span class="operator">.</span><span class="variable">index</span><span class="operator"> </span><span class="operator">-</span><span class="operator"> </span><span class="number">1</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">beforeIndex</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator">[</span><span class="variable">beforeIndex</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;[&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">continue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">calls</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="variable">fullName</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">calls</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 5: DEPENDENCY EXTRACTION</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Extracts namespace dependencies from C# using directives.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Identifies external dependencies and imports used by the code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Features: - Detects standard using directives: using System.IO; - Detects global using</span></div>
            <div class="code-line"><span class="comment">directives: global using System; - Detects static using directives: using static System.</span></div>
            <div class="code-line"><span class="comment">Math; - Detects using aliases: using File = System.IO.File;</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Output format: - Regular imports: &quot;System.IO&quot; - Aliases: &quot;File=System.IO.File&quot;</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Performance: - Limits to 5,000 iterations to prevent infinite loops</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} code - C# source code to analyze @returns {Set&lt;string&gt;} Set of dependency</span></div>
            <div class="code-line"><span class="comment">strings (namespaces and aliases)</span></div>
            <div class="code-line"><span class="keyword">export</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">extractCSharpDependencies</span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">sanitizeCSharpCode</span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">dependencies</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Pattern matches all forms of using directives</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">usingRegex</span><span class="operator"> </span><span class="operator">=</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">/</span><span class="operator">^</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="variable">global</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">)</span><span class="operator">?</span><span class="variable">using</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="variable">static</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">)</span><span class="operator">?</span><span class="operator">(</span><span class="operator">?</span><span class="operator">:</span><span class="operator">(</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">]</span><span class="operator">*</span><span class="operator">)</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">=</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">)</span><span class="operator">?</span><span class="operator">(</span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z_</span><span class="operator">]</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">[</span><span class="type">A</span><span class="operator">-</span><span class="type">Za</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">.</span><span class="operator">]</span><span class="operator">*</span><span class="operator">)</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">;</span><span class="operator">/</span><span class="variable">gm</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">match</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">5000</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="operator">(</span><span class="variable">match</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">usingRegex</span><span class="operator">.</span><span class="function">exec</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">iterations</span><span class="operator">+</span><span class="operator">+</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">alias</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">match</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">target</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">match</span><span class="operator">[</span><span class="number">2</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">alias</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">dependencies</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`${alias}=${target}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">dependencies</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="variable">target</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">dependencies</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 6: DATA FLOW SUMMARIZATION</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Summarizes data flow characteristics of C# code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Provides high-level view of how code interacts with state, storage, network,</span></div>
            <div class="code-line"><span class="comment">logging, and configuration.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Output format: &quot;Category1{details} | Category2{details} | ...&quot;</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Categories detected: - Globals: Static field declarations (writes to global state) -</span></div>
            <div class="code-line"><span class="comment">Events: Event subscriptions using += operator - Input: Console input operations - Storage:</span></div>
            <div class="code-line"><span class="comment">File read/write operations - Network: HTTP and WebClient operations - Logs: Logging and</span></div>
            <div class="code-line"><span class="comment">console output - Config: Configuration access (environment vars, IConfiguration, etc.) -</span></div>
            <div class="code-line"><span class="comment">SharedState: Using directives (imported dependencies)</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Delegation: Uses collectCSharpIoCategories and collectEventSubscriptions</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} code - C# source code to analyze @returns {string} Pipe-separated summary</span></div>
            <div class="code-line"><span class="comment">of data flow categories</span></div>
            <div class="code-line"><span class="keyword">export</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">summarizeCSharpDataFlow</span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">sanitizeCSharpCode</span><span class="operator">(</span><span class="variable">code</span><span class="operator">,</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">removeStrings</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">true</span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">globals</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">staticMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">5000</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Extract static field declarations (global state writes)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="type">STATIC_FIELD_REGEX</span><span class="operator">.</span><span class="variable">lastIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="operator">(</span><span class="variable">staticMatch</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="type">STATIC_FIELD_REGEX</span><span class="operator">.</span><span class="function">exec</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">iterations</span><span class="operator">+</span><span class="operator">+</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">globals</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="variable">staticMatch</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Extract event subscriptions</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">events</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">collectEventSubscriptions</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Categorize I/O operations</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">categories</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">collectCSharpIoCategories</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Extract dependencies</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">dependencies</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">extractCSharpDependencies</span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">sharedState</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">dependencies</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">dep</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">sharedState</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`using:${dep}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Build summary segments</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">segments</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">globals</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`Globals{write=[${Array.from(globals).sort().join(&#039;, &#039;)}]}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">events</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`Events{subscribe=[${Array.from(events).sort().join(&#039;, &#039;)}]}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">consoleRead</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="string">`Input{console=[${Array.from(categories.consoleRead).sort().join(&#039;, &#039;)}]}`</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">fileRead</span><span class="operator">.</span><span class="variable">size</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">fileWrite</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">parts</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">fileRead</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">parts</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`read=[${Array.from(categories.fileRead).sort().join(&#039;, &#039;)}]`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">fileWrite</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">parts</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`write=[${Array.from(categories.fileWrite).sort().join(&#039;, &#039;)}]`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`Storage{${parts.join(&#039;; &#039;)}}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkRead</span><span class="operator">.</span><span class="variable">size</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkWrite</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">parts</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkRead</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">parts</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`read=[${Array.from(categories.networkRead).sort().join(&#039;, &#039;)}]`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkWrite</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">parts</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`write=[${Array.from(categories.networkWrite).sort().join(&#039;, &#039;)}]`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`Network{${parts.join(&#039;; &#039;)}}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">logs</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`Logs{emit=[${Array.from(categories.logs).sort().join(&#039;, &#039;)}]}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">categories</span><span class="operator">.</span><span class="variable">configRead</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`Config{read=[${Array.from(categories.configRead).sort().join(&#039;, &#039;)}]}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">sharedState</span><span class="operator">.</span><span class="variable">size</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">`SharedState{${Array.from(sharedState).sort().join(&#039;, &#039;)}}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="string">&#039; | &#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 7: I/O ANALYSIS</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Analyzes input/output operations in C# code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Categorizes all I/O operations as inputs or outputs with specific type labels.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Output format: - inputs: Set of &quot;TYPE:operation&quot; strings - outputs: Set of</span></div>
            <div class="code-line"><span class="comment">&quot;TYPE:operation&quot; strings</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Type prefixes: - FILE: File system operations - USER: Console/event user interactions -</span></div>
            <div class="code-line"><span class="comment">LOG: Logging and console output - NETWORK: HTTP and web operations - CONFIG: Configuration</span></div>
            <div class="code-line"><span class="comment">reading</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Delegation: Uses collectCSharpIoCategories and collectEventSubscriptions</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} code - C# source code to analyze @returns {{inputs: Set&lt;string&gt;, outputs:</span></div>
            <div class="code-line"><span class="comment">Set&lt;string&gt;}} Categorized I/O operations</span></div>
            <div class="code-line"><span class="keyword">export</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">analyzeCSharpIO</span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">sanitized</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">sanitizeCSharpCode</span><span class="operator">(</span><span class="variable">code</span><span class="operator">,</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">removeStrings</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">true</span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">inputs</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">outputs</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Collect all I/O categories</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">categories</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">collectCSharpIoCategories</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Categorize as inputs or outputs with type prefixes</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">fileRead</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">inputs</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`FILE:${name}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">fileWrite</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">outputs</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`FILE:${name}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">consoleRead</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">inputs</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`USER:${name}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">logs</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">outputs</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`LOG:${name}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkRead</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">inputs</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`NETWORK:${name}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkWrite</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">outputs</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`NETWORK:${name}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">configRead</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">inputs</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`CONFIG:${name}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Event subscriptions are user inputs</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">events</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">collectEventSubscriptions</span><span class="operator">(</span><span class="variable">sanitized</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">events</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">evt</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">inputs</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">`USER:${evt}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">inputs</span><span class="operator">,</span><span class="operator"> </span><span class="variable">outputs</span><span class="operator"> </span><span class="operator">}</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 8: I/O CATEGORIZATION HELPERS</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Categorizes all I/O operations found in sanitized C# code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Internal helper that classifies I/O operations into specific categories for data</span></div>
            <div class="code-line"><span class="comment">flow and I/O analysis.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Detection methods: - Simple pattern matching for well-known API calls - Regex matching for</span></div>
            <div class="code-line"><span class="comment">flexible patterns (loggers, config) - Special handling for HttpClient (detects specific</span></div>
            <div class="code-line"><span class="comment">HTTP methods) - Special handling for WebRequest patterns</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Categories: - fileRead: File.ReadAllText, Directory.GetFiles, etc. - fileWrite: File.</span></div>
            <div class="code-line"><span class="comment">WriteAllText, Directory.CreateDirectory, etc. - networkRead: WebClient.DownloadString,</span></div>
            <div class="code-line"><span class="comment">HttpClient.GetAsync, etc. - networkWrite: WebClient.UploadData, HttpClient.PostAsync, etc.</span></div>
            <div class="code-line"><span class="comment">- logs: Console.WriteLine, ILogger.Log, Debug.WriteLine, etc. - configRead: Environment.</span></div>
            <div class="code-line"><span class="comment">GetEnvironmentVariable, IConfiguration, etc. - consoleRead: Console.ReadLine, Console.</span></div>
            <div class="code-line"><span class="comment">ReadKey, etc.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} text - Sanitized C# code (comments and strings removed) @returns {{</span></div>
            <div class="code-line"><span class="comment">fileRead: Set&lt;string&gt;, fileWrite: Set&lt;string&gt;, networkRead: Set&lt;string&gt;, networkWrite: Set&lt;</span></div>
            <div class="code-line"><span class="comment">string&gt;, logs: Set&lt;string&gt;, configRead: Set&lt;string&gt;, consoleRead: Set&lt;string&gt; }}</span></div>
            <div class="code-line"><span class="comment">Categorized I/O operations</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">collectCSharpIoCategories</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">categories</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">fileRead</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">fileWrite</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">networkRead</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">networkWrite</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">logs</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">configRead</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">consoleRead</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Collect simple API call patterns</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectSimpleCalls</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">FILE_READ_CALLS</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">fileRead</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectSimpleCalls</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">FILE_WRITE_CALLS</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">fileWrite</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectSimpleCalls</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">CONSOLE_INPUT_CALLS</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">consoleRead</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectSimpleCalls</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">LOG_CALLS</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">logs</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectSimpleCalls</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">WEBCLIENT_READ_CALLS</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkRead</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectSimpleCalls</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">WEBCLIENT_WRITE_CALLS</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkWrite</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectSimpleCalls</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">HTTP_WEB_REQUEST_CALLS</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkRead</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Collect regex-based patterns (flexible matching)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectRegexMatchesList</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">LOGGER_REGEXES</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">logs</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">collectRegexMatchesList</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="type">CONFIG_REGEXES</span><span class="operator">,</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">configRead</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Special handling for HttpClient (modern HTTP client)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="variable">bHttpClient</span><span class="operator">\</span><span class="variable">b</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">bIHttpClientFactory</span><span class="operator">\</span><span class="variable">b</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="operator">.</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="type">GetAsync</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="operator">.</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="type">GetStringAsync</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkRead</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">&#039;HttpClient.GetAsync&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="operator">.</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="type">PostAsync</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkWrite</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">&#039;HttpClient.PostAsync&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="operator">.</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="type">PutAsync</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkWrite</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">&#039;HttpClient.PutAsync&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="operator">.</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="type">DeleteAsync</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkWrite</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">&#039;HttpClient.DeleteAsync&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="operator">.</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="type">SendAsync</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">\</span><span class="operator">(</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkWrite</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">&#039;HttpClient.SendAsync&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="comment">Special handling for WebRequest (legacy HTTP)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="variable">bWebRequest</span><span class="operator">\</span><span class="variable">b</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">bHttpWebRequest</span><span class="operator">\</span><span class="variable">b</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">categories</span><span class="operator">.</span><span class="variable">networkRead</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="string">&#039;HttpWebRequest.Create&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">categories</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Extracts event subscription patterns from C# code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Identifies event subscriptions using += operator, which indicates user</span></div>
            <div class="code-line"><span class="comment">interaction points in GUI or event-driven code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Pattern: object.EventName += handler Extracts: &quot;EventName&quot;</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Performance: Limits to 5,000 iterations to prevent infinite loops</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} text - Sanitized C# code (comments and strings removed) @returns {Set&lt;</span></div>
            <div class="code-line"><span class="comment">string&gt;} Set of event names being subscribed to</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">collectEventSubscriptions</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">events</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Set</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">match</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">5000</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="type">EVENT_SUBSCRIPTION_REGEX</span><span class="operator">.</span><span class="variable">lastIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="operator">(</span><span class="variable">match</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="type">EVENT_SUBSCRIPTION_REGEX</span><span class="operator">.</span><span class="function">exec</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">iterations</span><span class="operator">+</span><span class="operator">+</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">full</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">match</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">parts</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">full</span><span class="operator">.</span><span class="function">split</span><span class="operator">(</span><span class="string">&#039;.&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">name</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">parts</span><span class="operator">[</span><span class="variable">parts</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">-</span><span class="operator"> </span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">events</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">events</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Searches for exact API call patterns in code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Efficiently detects specific API calls by exact name matching.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Process: - Escapes each pattern for use in regex - Creates regex that matches pattern</span></div>
            <div class="code-line"><span class="comment">followed by opening paren - Tests for presence and adds to target set if found</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Example: &quot;File.ReadAllText&quot; → /\bFile\.ReadAllText\s*\(/</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} text - Sanitized C# code (comments and strings removed) @param {string[]}</span></div>
            <div class="code-line"><span class="comment">patterns - Array of exact API call patterns to find @param {Set&lt;string&gt;} targetSet - Set</span></div>
            <div class="code-line"><span class="comment">to populate with found patterns @returns {void}</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">collectSimpleCalls</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="variable">patterns</span><span class="operator">,</span><span class="operator"> </span><span class="variable">targetSet</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">patterns</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">pattern</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">regex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">RegExp</span><span class="operator">(</span><span class="string">`\\b${escapeRegex(pattern)}\\s*\\(`</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;g&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">regex</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">targetSet</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="variable">pattern</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Searches for flexible regex patterns in code.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Detects API usage with flexible patterns that can match variations (e.g.,</span></div>
            <div class="code-line"><span class="comment">different logger method names).</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Process: - Tests each regex pattern against the code - Adds the associated label (not the</span></div>
            <div class="code-line"><span class="comment">match) to target set - Allows one pattern to represent multiple variations</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Example: Logger pattern matches ILogger.LogInformation, ILogger.LogError, etc. but all are</span></div>
            <div class="code-line"><span class="comment">labeled as &quot;ILogger.Log&quot;</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} text - Sanitized C# code (comments and strings removed) @param {Array&lt;{</span></div>
            <div class="code-line"><span class="comment">regex: RegExp, label: string}&gt;} descriptors - Pattern descriptors @param {Set&lt;string&gt;}</span></div>
            <div class="code-line"><span class="comment">targetSet - Set to populate with labels of matched patterns @returns {void}</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">collectRegexMatchesList</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="variable">descriptors</span><span class="operator">,</span><span class="operator"> </span><span class="variable">targetSet</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">descriptors</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="operator">{</span><span class="operator"> </span><span class="variable">regex</span><span class="operator">,</span><span class="operator"> </span><span class="variable">label</span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">tester</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">RegExp</span><span class="operator">(</span><span class="variable">regex</span><span class="operator">.</span><span class="variable">source</span><span class="operator">,</span><span class="operator"> </span><span class="variable">regex</span><span class="operator">.</span><span class="variable">flags</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">tester</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">targetSet</span><span class="operator">.</span><span class="function">add</span><span class="operator">(</span><span class="variable">label</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 9: UTILITY HELPERS</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Escapes special regex characters in a string.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Safely converts literal strings into regex patterns by escaping all special regex</span></div>
            <div class="code-line"><span class="comment">metacharacters.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Escaped characters: . * + ? ^ $ { } ( ) | [ ] \</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Example: &quot;File.ReadAllText&quot; → &quot;File\\.ReadAllText&quot;</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} value - String to escape for regex use @returns {string} Escaped string</span></div>
            <div class="code-line"><span class="comment">safe for use in regex pattern</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">escapeRegex</span><span class="operator">(</span><span class="variable">value</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">value</span><span class="operator">.</span><span class="function">replace</span><span class="operator">(</span><span class="operator">/</span><span class="operator">[</span><span class="operator">.</span><span class="operator">*</span><span class="operator">+</span><span class="operator">?</span><span class="operator">^</span><span class="operator">$</span><span class="operator">{</span><span class="operator">}</span><span class="operator">(</span><span class="operator">)</span><span class="operator">|</span><span class="operator">[</span><span class="operator">\</span><span class="operator">]</span><span class="operator">\</span><span class="operator">\</span><span class="operator">]</span><span class="operator">/</span><span class="variable">g</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;\\$&amp;&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Skips forward over whitespace characters.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Finds the next non-whitespace character position.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Behavior: - Starts at given index - Advances while encountering whitespace (\s) - Returns</span></div>
            <div class="code-line"><span class="comment">index of first non-whitespace character - Returns -1 if reached end of text</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} text - Text to scan @param {number} index - Starting position @returns {</span></div>
            <div class="code-line"><span class="comment">number} Index of next non-whitespace char, or -1 if end reached</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">skipWhitespace</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="variable">index</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">index</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="variable">i</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">s</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator">=</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="variable">i</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Skips backward over whitespace characters.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Finds the previous non-whitespace character position.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Behavior: - Starts at given index - Moves backward while encountering whitespace (\s) -</span></div>
            <div class="code-line"><span class="comment">Returns index of first non-whitespace character found - Returns index unchanged if already</span></div>
            <div class="code-line"><span class="comment">at beginning</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} text - Text to scan @param {number} index - Starting position @returns {</span></div>
            <div class="code-line"><span class="comment">number} Index of previous non-whitespace char</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">skipWhitespaceBackward</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="variable">index</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">index</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">while</span><span class="operator"> </span><span class="operator">(</span><span class="variable">i</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="operator">/</span><span class="operator">\</span><span class="variable">s</span><span class="operator">/</span><span class="operator">.</span><span class="function">test</span><span class="operator">(</span><span class="variable">text</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">-</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">i</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Finds the matching closing parenthesis with safety limits.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Locates the closing paren for a given opening paren, handling nested parentheses</span></div>
            <div class="code-line"><span class="comment">correctly.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Features: - Tracks nesting depth - Safety limit: stops after 50,000 iterations - Returns</span></div>
            <div class="code-line"><span class="comment">-1 if no valid match found</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Algorithm: - Starts with depth 0 at opening paren - Increments depth for each &#039;(&#039; -</span></div>
            <div class="code-line"><span class="comment">Decrements depth for each &#039;)&#039; - Returns position when depth reaches 0</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">@param {string} text - Text to search @param {number} openIndex - Position of opening</span></div>
            <div class="code-line"><span class="comment">parenthesis @returns {number} Index of matching closing paren, or -1 if not found</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">findClosingParen</span><span class="operator">(</span><span class="variable">text</span><span class="operator">,</span><span class="operator"> </span><span class="variable">openIndex</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">depth</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">50000</span><span class="operator">;</span><span class="operator"> </span><span class="comment">Safety limit</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">for</span><span class="operator"> </span><span class="operator">(</span><span class="keyword">let</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">openIndex</span><span class="operator">;</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">iterations</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">maxIterations</span><span class="operator">;</span><span class="operator"> </span><span class="variable">i</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">iterations</span><span class="operator">+</span><span class="operator">+</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">text</span><span class="operator">[</span><span class="variable">i</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;(&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">depth</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">char</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;)&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">depth</span><span class="operator"> </span><span class="operator">-</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">depth</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">i</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
        </div>
    </div>
</body>
</html>