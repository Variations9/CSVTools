<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatted Code - JavaScript</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background: #ffffff;
            padding: 3rem;
            color: #000000;
            line-height: 1.6;
            font-size: 12pt;
            font-weight: bold;
            font-style: normal;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
        }

        .code-container {
            background: #ffffff;
            padding: 0;
        }

        .code-line {
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-bottom: 0.1rem;
        }

        .comment {
            color: #228b22;
            font-size: 11pt;
            font-family: 'Bookman Old Style', serif;
            font-weight: normal;
            font-style: normal;
        }

        .keyword {
            color: #0000ff;
            font-weight: 600;
        }

        .string {
            color: #a31515;
        }

        .number {
            color: #098658;
        }

        .function {
            color: #795e26;
        }

        .operator {
            color: #000000;
        }

        .type {
            color: #267f99;
        }

        .variable {
            color: #001080;
        }

        @media print {
            body {
                padding: 1rem;
            }

            .code-container {
                border: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="code-container">
            <div class="code-line"><span class="comment">CSV PROJECT MAP - TEST COVERAGE EXTRACTION WORKFLOW</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">SECTION 1: DEPENDENCIES AND CSV HELPERS</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="keyword">import</span><span class="operator"> </span><span class="variable">fs</span><span class="operator"> </span><span class="keyword">from</span><span class="operator"> </span><span class="string">&#039;node:fs/promises&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">import</span><span class="operator"> </span><span class="variable">path</span><span class="operator"> </span><span class="keyword">from</span><span class="operator"> </span><span class="string">&#039;node:path&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">import</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">spawn</span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">from</span><span class="operator"> </span><span class="string">&#039;node:child_process&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">import</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">loadCsvTable</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">writeCsvTable</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">ensureColumn</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">resolveCsvPath</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">}</span><span class="operator"> </span><span class="keyword">from</span><span class="operator"> </span><span class="string">&#039;./lib/table-helpers.mjs&#039;</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 2: CONFIGURATION CONSTANTS</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Workspace paths and environment switches</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Centralize configuration details used throughout the coverage update flow.</span></div>
            <div class="code-line"><span class="comment">Components: - workspaceRoot: Base directory anchoring relative path resolution. -</span></div>
            <div class="code-line"><span class="comment">coverageDir: Directory containing coverage artifacts (overridable via env). -</span></div>
            <div class="code-line"><span class="comment">coverageFile: LCOV file consumed by the parser. - testWorkspace: Working directory for</span></div>
            <div class="code-line"><span class="comment">spawning npm coverage runs. - SKIP_TEST_RUN: Flag to reuse existing coverage output. -</span></div>
            <div class="code-line"><span class="comment">COVERAGE_ARGS: Optional extra arguments passed through to the coverage script.</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="variable">workspaceRoot</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="function">cwd</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="variable">coverageDir</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">resolveCoverageDir</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="variable">coverageFile</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="variable">coverageDir</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;lcov.info&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="variable">testWorkspace</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">resolveTestWorkspace</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">SKIP_TEST_RUN</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="variable">env</span><span class="operator">.</span><span class="type">SKIP_TEST_COVERAGE</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;true&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">COVERAGE_ARGS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="variable">env</span><span class="operator">.</span><span class="type">TEST_COVERAGE_ARGS</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="variable">env</span><span class="operator">.</span><span class="type">TEST_COVERAGE_ARGS</span><span class="operator">.</span><span class="function">split</span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="variable">s</span><span class="operator">+</span><span class="operator">/</span><span class="operator">)</span><span class="operator">.</span><span class="function">filter</span><span class="operator">(</span><span class="type">Boolean</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 3: WORKFLOW CONTROLLER</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">main</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Drive the end-to-end update of the &quot;TEST COVERAGE&quot; CSV column. Behavior: -</span></div>
            <div class="code-line"><span class="comment">Optionally runs the native test coverage script unless explicitly skipped. - Parses LCOV</span></div>
            <div class="code-line"><span class="comment">results into a normalized path map. - Loads the project CSV and ensures the coverage</span></div>
            <div class="code-line"><span class="comment">column exists. - Applies coverage strings to rows representing files. - Persists updated</span></div>
            <div class="code-line"><span class="comment">rows when changes are detected. Delegation: - runNativeCoverage for executing npm coverage.</span></div>
            <div class="code-line"><span class="comment">- parseLcov for building the coverage metrics map. - loadCsvTable/writeCsvTable for CSV</span></div>
            <div class="code-line"><span class="comment">I/O. - buildRelativePath/normalizePath/formatCoverage helpers for row updates. Parameters:</span></div>
            <div class="code-line"><span class="comment">None Returns: Promise&lt;void&gt; Key Features: - Provides detailed progress logging with step</span></div>
            <div class="code-line"><span class="comment">counters. - Supports incremental reruns by honoring SKIP_TEST_RUN.</span></div>
            <div class="code-line"><span class="keyword">async</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">main</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;============================================================&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;Test Coverage Extraction (Column V)&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;============================================================\n&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="type">SKIP_TEST_RUN</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="function">runNativeCoverage</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="operator">(</span><span class="keyword">await</span><span class="operator"> </span><span class="function">fileExists</span><span class="operator">(</span><span class="variable">coverageFile</span><span class="operator">)</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">throw</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Error</span><span class="operator">(</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="string">`Coverage file not found at ${coverageFile}. Re-run without SKIP_TEST_COVERAGE or</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">generate</span><span class="operator"> </span><span class="variable">coverage</span><span class="operator"> </span><span class="variable">manually</span><span class="operator">.</span><span class="string">`</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;[2/5] Parsing coverage report...&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">coverageMap</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="function">parseLcov</span><span class="operator">(</span><span class="variable">coverageFile</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">`        Coverage entries discovered: ${coverageMap.size}\n`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;[3/5] Loading CSV data...&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">headers</span><span class="operator">,</span><span class="operator"> </span><span class="variable">rows</span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="function">loadCsvTable</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">typeIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">headers</span><span class="operator">.</span><span class="function">findIndex</span><span class="operator">(</span><span class="operator">(</span><span class="variable">header</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">header</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="function">toUpperCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;TYPE&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">typeIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="operator">-</span><span class="number">1</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">throw</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Error</span><span class="operator">(</span><span class="string">&#039;Unable to locate &quot;Type&quot; column in CSV header.&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">coverageIndex</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">ensureColumn</span><span class="operator">(</span><span class="variable">headers</span><span class="operator">,</span><span class="operator"> </span><span class="variable">rows</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;TEST COVERAGE&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;[4/5] Applying coverage metrics to rows...&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">updated</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">matched</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">rows</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">row</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">typeValue</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="variable">row</span><span class="operator">[</span><span class="variable">typeIndex</span><span class="operator">]</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="function">toLowerCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">typeValue</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">typeValue</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;folder&#039;</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="operator">!</span><span class="variable">typeValue</span><span class="operator">.</span><span class="function">endsWith</span><span class="operator">(</span><span class="string">&#039;file&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">relativePath</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">buildRelativePath</span><span class="operator">(</span><span class="variable">row</span><span class="operator">,</span><span class="operator"> </span><span class="variable">typeIndex</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">relativePath</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">normalizedPath</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">normalizePath</span><span class="operator">(</span><span class="variable">relativePath</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">metrics</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">coverageMap</span><span class="operator">.</span><span class="function">get</span><span class="operator">(</span><span class="variable">normalizedPath</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">metrics</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">matched</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">nextValue</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">formatCoverage</span><span class="operator">(</span><span class="variable">metrics</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">(</span><span class="variable">row</span><span class="operator">[</span><span class="variable">coverageIndex</span><span class="operator">]</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="variable">nextValue</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">row</span><span class="operator">[</span><span class="variable">coverageIndex</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">nextValue</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">updated</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">`        Rows matched:  ${matched}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">`        Rows updated:  ${updated}`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">updated</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;No updates were required; Column V already reflects current coverage.&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;\n[5/5] Writing CSV...&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="function">writeCsvTable</span><span class="operator">(</span><span class="function">resolveCsvPath</span><span class="operator">(</span><span class="operator">)</span><span class="operator">,</span><span class="operator"> </span><span class="variable">headers</span><span class="operator">,</span><span class="operator"> </span><span class="variable">rows</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;Test coverage update completed.&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 4: COVERAGE EXECUTION</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">runNativeCoverage</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Execute the npm coverage script to regenerate LCOV artifacts. Behavior: - Removes</span></div>
            <div class="code-line"><span class="comment">stale coverage directory to avoid mixing results. - Spawns `npm run test:coverage`,</span></div>
            <div class="code-line"><span class="comment">optionally passing through extra arguments. - Resolves when the child process exits</span></div>
            <div class="code-line"><span class="comment">successfully, rejects on errors. Delegation: - Uses child_process.spawn for process</span></div>
            <div class="code-line"><span class="comment">management. Parameters: None Returns: Promise&lt;void&gt; Key Features: - Cross-platform npm</span></div>
            <div class="code-line"><span class="comment">command resolution (npm vs npm.cmd). - Emits informative logging around command execution.</span></div>
            <div class="code-line"><span class="keyword">async</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">runNativeCoverage</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;[1/5] Running npm test:coverage (Mocha + c8)...&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="variable">fs</span><span class="operator">.</span><span class="function">rm</span><span class="operator">(</span><span class="variable">coverageDir</span><span class="operator">,</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">recursive</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">true</span><span class="operator">,</span><span class="operator"> </span><span class="variable">force</span><span class="operator">:</span><span class="operator"> </span><span class="keyword">true</span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Promise</span><span class="operator">(</span><span class="operator">(</span><span class="variable">resolve</span><span class="operator">,</span><span class="operator"> </span><span class="variable">reject</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">npmCommand</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="variable">platform</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;win32&#039;</span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="string">&#039;npm.cmd&#039;</span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;npm&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">npmArgs</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="string">&#039;run&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;test:coverage&#039;</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="type">COVERAGE_ARGS</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">npmArgs</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="string">&#039;--&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator">.</span><span class="operator">.</span><span class="operator">.</span><span class="type">COVERAGE_ARGS</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">child</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">spawn</span><span class="operator">(</span><span class="variable">npmCommand</span><span class="operator">,</span><span class="operator"> </span><span class="variable">npmArgs</span><span class="operator">,</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">cwd</span><span class="operator">:</span><span class="operator"> </span><span class="variable">testWorkspace</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">stdio</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;inherit&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">child</span><span class="operator">.</span><span class="function">on</span><span class="operator">(</span><span class="string">&#039;close&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator">(</span><span class="variable">code</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">code</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="function">resolve</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="function">reject</span><span class="operator">(</span><span class="keyword">new</span><span class="operator"> </span><span class="function">Error</span><span class="operator">(</span><span class="string">`Coverage run exited with code ${code}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">child</span><span class="operator">.</span><span class="function">on</span><span class="operator">(</span><span class="string">&#039;error&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="operator">(</span><span class="variable">error</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="function">reject</span><span class="operator">(</span><span class="keyword">new</span><span class="operator"> </span><span class="function">Error</span><span class="operator">(</span><span class="string">`Unable to launch test coverage: ${error.message}`</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">log</span><span class="operator">(</span><span class="string">&#039;        Coverage artifacts generated.\n&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 5: COVERAGE PARSING</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">parseLcov</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Convert LCOV coverage data into a map keyed by normalized file paths. Behavior: -</span></div>
            <div class="code-line"><span class="comment">Reads the LCOV file and iterates through records. - Maintains counters for total lines and</span></div>
            <div class="code-line"><span class="comment">covered lines per source file. - Stores percentage metrics for files residing under the</span></div>
            <div class="code-line"><span class="comment">workspace root. Delegation: - normalizePath for consistent path separators. Parameters: - {</span></div>
            <div class="code-line"><span class="comment">string} filePath: Absolute path to an LCOV file. Returns: Promise&lt;Map&lt;string, {</span></div>
            <div class="code-line"><span class="comment">total:number, covered:number, pct:number}&gt;&gt;. Key Features: - Filters out entries outside</span></div>
            <div class="code-line"><span class="comment">the workspace to avoid node_modules noise. - Produces percentages rounded to two decimal</span></div>
            <div class="code-line"><span class="comment">places for stable CSV output.</span></div>
            <div class="code-line"><span class="keyword">async</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">parseLcov</span><span class="operator">(</span><span class="variable">filePath</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">text</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="variable">fs</span><span class="operator">.</span><span class="function">readFile</span><span class="operator">(</span><span class="variable">filePath</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;utf8&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">lines</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="function">split</span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="variable">r</span><span class="operator">?</span><span class="operator">\</span><span class="variable">n</span><span class="operator">/</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">coverage</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">new</span><span class="operator"> </span><span class="function">Map</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">currentFile</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">total</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">let</span><span class="operator"> </span><span class="variable">covered</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">resolveCoveragePath</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="variable">inputPath</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">inputPath</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">absolutePath</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">isAbsolute</span><span class="operator">(</span><span class="variable">inputPath</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="variable">inputPath</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="variable">testWorkspace</span><span class="operator">,</span><span class="operator"> </span><span class="variable">inputPath</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="function">normalizePath</span><span class="operator">(</span><span class="variable">path</span><span class="operator">.</span><span class="function">relative</span><span class="operator">(</span><span class="variable">workspaceRoot</span><span class="operator">,</span><span class="operator"> </span><span class="variable">absolutePath</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">flush</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">currentFile</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">normalized</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">resolveCoveragePath</span><span class="operator">(</span><span class="variable">currentFile</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">normalized</span><span class="operator">.</span><span class="function">startsWith</span><span class="operator">(</span><span class="string">&#039;..&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="variable">total</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">pct</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">Number</span><span class="operator">(</span><span class="operator">(</span><span class="operator">(</span><span class="variable">covered</span><span class="operator"> </span><span class="operator">/</span><span class="operator"> </span><span class="variable">total</span><span class="operator">)</span><span class="operator"> </span><span class="operator">*</span><span class="operator"> </span><span class="number">100</span><span class="operator">)</span><span class="operator">.</span><span class="function">toFixed</span><span class="operator">(</span><span class="number">2</span><span class="operator">)</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">coverage</span><span class="operator">.</span><span class="function">set</span><span class="operator">(</span><span class="variable">normalized</span><span class="operator">,</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">total</span><span class="operator">,</span><span class="operator"> </span><span class="variable">covered</span><span class="operator">,</span><span class="operator"> </span><span class="variable">pct</span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">currentFile</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="keyword">null</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">total</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">covered</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">lines</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">line</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">line</span><span class="operator">.</span><span class="function">startsWith</span><span class="operator">(</span><span class="string">&#039;SF:&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="function">flush</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">currentFile</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">line</span><span class="operator">.</span><span class="function">slice</span><span class="operator">(</span><span class="number">3</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">line</span><span class="operator">.</span><span class="function">startsWith</span><span class="operator">(</span><span class="string">&#039;DA:&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="operator">[</span><span class="operator">,</span><span class="operator"> </span><span class="variable">hitValue</span><span class="operator">]</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">line</span><span class="operator">.</span><span class="function">slice</span><span class="operator">(</span><span class="number">3</span><span class="operator">)</span><span class="operator">.</span><span class="function">split</span><span class="operator">(</span><span class="string">&#039;,&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">total</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="function">Number</span><span class="operator">(</span><span class="variable">hitValue</span><span class="operator">)</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">covered</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">else</span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">line</span><span class="operator">.</span><span class="function">startsWith</span><span class="operator">(</span><span class="string">&#039;end_of_record&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="function">flush</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">flush</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">coverage</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 6: CSV ROW HELPERS</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">buildRelativePath</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Reconstruct the CSV path hierarchy up to the type column. Behavior: - Collects</span></div>
            <div class="code-line"><span class="comment">populated columns leading to the type index. - Joins segments with `/` to produce a</span></div>
            <div class="code-line"><span class="comment">relative path for lookup. Parameters: - {string[]} row: CSV row array. - {number}</span></div>
            <div class="code-line"><span class="comment">typeIndex: Index of the Type column within the row. Returns: string Key Features: -</span></div>
            <div class="code-line"><span class="comment">Ignores empty columns to prevent stray separators.</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">buildRelativePath</span><span class="operator">(</span><span class="variable">row</span><span class="operator">,</span><span class="operator"> </span><span class="variable">typeIndex</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">segments</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">for</span><span class="operator"> </span><span class="operator">(</span><span class="keyword">let</span><span class="operator"> </span><span class="variable">index</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">;</span><span class="operator"> </span><span class="variable">index</span><span class="operator"> </span><span class="operator">&lt;</span><span class="operator"> </span><span class="variable">typeIndex</span><span class="operator">;</span><span class="operator"> </span><span class="variable">index</span><span class="operator"> </span><span class="operator">+</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">value</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="variable">row</span><span class="operator">[</span><span class="variable">index</span><span class="operator">]</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">value</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="variable">value</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">segments</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">segments</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="string">&#039;/&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">normalizePath</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Standardize path separators for consistent map lookups. Parameters: - {string}</span></div>
            <div class="code-line"><span class="comment">input: Path string using platform-specific separators. Returns: string</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">normalizePath</span><span class="operator">(</span><span class="variable">input</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">input</span><span class="operator">.</span><span class="function">split</span><span class="operator">(</span><span class="variable">path</span><span class="operator">.</span><span class="variable">sep</span><span class="operator">)</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="string">&#039;/&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">formatCoverage</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Produce a human-readable coverage summary string. Behavior: - Formats percentage</span></div>
            <div class="code-line"><span class="comment">with two decimals. - Includes covered/total counts and a qualitative rating. Parameters: -</span></div>
            <div class="code-line"><span class="comment">{Object} metrics: Coverage object with pct, covered, and total numbers. Returns: string</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">formatCoverage</span><span class="operator">(</span><span class="variable">metrics</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">rating</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">classifyCoverage</span><span class="operator">(</span><span class="variable">metrics</span><span class="operator">.</span><span class="variable">pct</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">`${metrics.pct.toFixed(2)}% (${metrics.covered}/${metrics.total} lines, ${rating})</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">`;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">classifyCoverage</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Convert a numeric percentage into a qualitative rating label. Parameters: - {</span></div>
            <div class="code-line"><span class="comment">number} pct: Coverage percentage. Returns: &#039;Excellent&#039; | &#039;Good&#039; | &#039;Fair&#039; | &#039;Needs</span></div>
            <div class="code-line"><span class="comment">Attention&#039;</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">classifyCoverage</span><span class="operator">(</span><span class="variable">pct</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">pct</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator">=</span><span class="operator"> </span><span class="number">90</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;Excellent&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">pct</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator">=</span><span class="operator"> </span><span class="number">75</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;Good&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">pct</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator">=</span><span class="operator"> </span><span class="number">60</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;Fair&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;Needs Attention&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 7: FILE SYSTEM UTILITIES</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">fileExists</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Determine whether a file can be accessed on disk. Behavior: - Attempts fs.access</span></div>
            <div class="code-line"><span class="comment">and resolves to a boolean without throwing. Parameters: - {string} filePath: Absolute or</span></div>
            <div class="code-line"><span class="comment">relative file system path. Returns: Promise&lt;boolean&gt;</span></div>
            <div class="code-line"><span class="keyword">async</span><span class="operator"> </span><span class="keyword">function</span><span class="operator"> </span><span class="function">fileExists</span><span class="operator">(</span><span class="variable">filePath</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">try</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">await</span><span class="operator"> </span><span class="variable">fs</span><span class="operator">.</span><span class="function">access</span><span class="operator">(</span><span class="variable">filePath</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="keyword">true</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="keyword">catch</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="keyword">false</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">resolveCoverageDir</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Determine the directory containing coverage outputs. Behavior: - Uses</span></div>
            <div class="code-line"><span class="comment">TEST_COVERAGE_DIR when provided. - Falls back to Source/coverage relative to the workspace.</span></div>
            <div class="code-line"><span class="comment">Parameters: None Returns: string</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">resolveCoverageDir</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">override</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="variable">env</span><span class="operator">.</span><span class="type">TEST_COVERAGE_DIR</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">override</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">isAbsolute</span><span class="operator">(</span><span class="variable">override</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="variable">override</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="variable">workspaceRoot</span><span class="operator">,</span><span class="operator"> </span><span class="variable">override</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="variable">workspaceRoot</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;Source/coverage&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">resolveTestWorkspace</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Identify the working directory for coverage commands. Behavior: - Honors</span></div>
            <div class="code-line"><span class="comment">TEST_COVERAGE_CWD when supplied. - Defaults to the Source directory. Parameters: None</span></div>
            <div class="code-line"><span class="comment">Returns: string</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">resolveTestWorkspace</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">override</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="variable">env</span><span class="operator">.</span><span class="type">TEST_COVERAGE_CWD</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">override</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">isAbsolute</span><span class="operator">(</span><span class="variable">override</span><span class="operator">)</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="variable">override</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="variable">workspaceRoot</span><span class="operator">,</span><span class="operator"> </span><span class="variable">override</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">path</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="variable">workspaceRoot</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;Source&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Workflow bootstrap with fatal error handling.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Execute the main routine and exit non-zero on failure.</span></div>
            <div class="code-line"><span class="function">main</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="keyword">catch</span><span class="operator">(</span><span class="operator">(</span><span class="variable">error</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">console</span><span class="operator">.</span><span class="function">error</span><span class="operator">(</span><span class="string">&#039;Test coverage update failed:&#039;</span><span class="operator">,</span><span class="operator"> </span><span class="variable">error</span><span class="operator">.</span><span class="variable">message</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">process</span><span class="operator">.</span><span class="function">exit</span><span class="operator">(</span><span class="number">1</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
        </div>
    </div>
</body>
</html>