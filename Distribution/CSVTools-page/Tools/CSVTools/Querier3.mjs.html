<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatted Code - JavaScript</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background: #ffffff;
            padding: 3rem;
            color: #000000;
            line-height: 1.6;
            font-size: 12pt;
            font-weight: bold;
            font-style: normal;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: #ffffff;
        }

        .code-container {
            background: #ffffff;
            padding: 0;
        }

        .code-line {
            white-space: pre-wrap;
            word-wrap: break-word;
            margin-bottom: 0.1rem;
        }

        .comment {
            color: #228b22;
            font-size: 11pt;
            font-family: 'Bookman Old Style', serif;
            font-weight: normal;
            font-style: normal;
        }

        .keyword {
            color: #0000ff;
            font-weight: 600;
        }

        .string {
            color: #a31515;
        }

        .number {
            color: #098658;
        }

        .function {
            color: #795e26;
        }

        .operator {
            color: #000000;
        }

        .type {
            color: #267f99;
        }

        .variable {
            color: #001080;
        }

        @media print {
            body {
                padding: 1rem;
            }

            .code-container {
                border: none;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="code-container">
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">STRUCTURE FINDER QUERY UTILITIES</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 1: TARGET KEY EXTRACTION</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">extractKey</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Resolves the key or category identifier that drives structure-focused lookups.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Behavior: - Prefers query.json.key when supplied via structured payloads - Falls back to</span></div>
            <div class="code-line"><span class="comment">query.json.category for broader grouping requests - Scans plain text for patterns like</span></div>
            <div class="code-line"><span class="comment">&quot;key: value&quot; or &quot;key=value&quot; - Uses the fallback path (minus extension) when no explicit</span></div>
            <div class="code-line"><span class="comment">key is provided - Returns an empty string when all sources are missing</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Parameters: - query: { json?: { key?: unknown, category?: unknown }, text: string } -</span></div>
            <div class="code-line"><span class="comment">fallback: string | undefined</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Returns: string containing the normalized key identifier (possibly empty)</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Key Features: - Multi-source lookup: Supports structured JSON, loose text, and file path</span></div>
            <div class="code-line"><span class="comment">hints - Regex capture: Extracts token-like identifiers without relying on full JSON</span></div>
            <div class="code-line"><span class="comment">parsing - Defensive stringification: Safely converts values to strings before returning</span></div>
            <div class="code-line"><span class="keyword">function</span><span class="operator"> </span><span class="function">extractKey</span><span class="operator">(</span><span class="variable">query</span><span class="operator">,</span><span class="operator"> </span><span class="variable">fallback</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">query</span><span class="operator">.</span><span class="variable">json</span><span class="operator">?</span><span class="operator">.</span><span class="variable">key</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="function">String</span><span class="operator">(</span><span class="variable">query</span><span class="operator">.</span><span class="variable">json</span><span class="operator">.</span><span class="variable">key</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">query</span><span class="operator">.</span><span class="variable">json</span><span class="operator">?</span><span class="operator">.</span><span class="variable">category</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="function">String</span><span class="operator">(</span><span class="variable">query</span><span class="operator">.</span><span class="variable">json</span><span class="operator">.</span><span class="variable">category</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">match</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">query</span><span class="operator">.</span><span class="variable">text</span><span class="operator">.</span><span class="function">match</span><span class="operator">(</span><span class="operator">/</span><span class="variable">key</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">[</span><span class="operator">:</span><span class="operator">=</span><span class="operator">]</span><span class="operator">\</span><span class="variable">s</span><span class="operator">*</span><span class="operator">(</span><span class="operator">[</span><span class="variable">a</span><span class="operator">-</span><span class="variable">z0</span><span class="operator">-</span><span class="number">9</span><span class="variable">_</span><span class="operator">-</span><span class="operator">]</span><span class="operator">+</span><span class="operator">)</span><span class="operator">/</span><span class="variable">i</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">match</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">match</span><span class="operator">[</span><span class="number">1</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">fallback</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">fallback</span><span class="operator">.</span><span class="function">replace</span><span class="operator">(</span><span class="operator">/</span><span class="operator">\</span><span class="operator">.</span><span class="operator">[</span><span class="operator">^</span><span class="operator">.</span><span class="operator">]</span><span class="operator">+</span><span class="operator">$</span><span class="operator">/</span><span class="operator">,</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">Ordered list of columns inspected for JSON-like snippets tied to data structures.</span></div>
            <div class="code-line"><span class="keyword">const</span><span class="operator"> </span><span class="type">STRUCTURE_COLUMNS</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;DATA FLOW / STATE MANAGEMENT&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;INPUT SOURCES / OUTPUT DESTINATIONS&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;QUERY RESULTS&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="string">&#039;SIDE EFFECTS&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line"><span class="comment">SECTION 2: STRUCTURE FINDER MODULE</span></div>
            <div class="code-line"><span class="comment">==========================================================================================</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">structure-finder query module definition consumed by the CSV tooling runtime.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Detects JSON-like fragments across catalog rows to assist with data flow</span></div>
            <div class="code-line"><span class="comment">debugging.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Key Features: - Declares tool metadata (id and description) - Provides activation logic</span></div>
            <div class="code-line"><span class="comment">via matches() - Offers execution logic via run()</span></div>
            <div class="code-line"><span class="keyword">export</span><span class="operator"> </span><span class="keyword">default</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">id</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;structure-finder&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="variable">description</span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;Surfaces JSON-like structures and schema hints for debugging data flow.&#039;</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span></div>
            <div class="code-line"><span class="comment">matches</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Determines whether the current query should be handled by the structure finder.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Behavior: - Activates when the JSON payload declares type === &quot;structure&quot; - Recognizes</span></div>
            <div class="code-line"><span class="comment">free-form text requests mentioning &quot;data structure&quot; or &quot;json&quot;</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Parameters: - context: { query: { json?: { type?: string }, text: string } }</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Returns: boolean indicating whether to execute the structure finder</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Key Features: - Lightweight guard: Prevents unnecessary scans for unrelated queries -</span></div>
            <div class="code-line"><span class="comment">Textual resilience: Supports plain-language requests outside JSON payloads</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">matches</span><span class="operator">(</span><span class="variable">context</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">context</span><span class="operator">.</span><span class="variable">query</span><span class="operator">.</span><span class="variable">json</span><span class="operator">?</span><span class="operator">.</span><span class="variable">type</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="string">&#039;structure&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="keyword">true</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">text</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">context</span><span class="operator">.</span><span class="variable">query</span><span class="operator">.</span><span class="variable">text</span><span class="operator">.</span><span class="function">toLowerCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="function">includes</span><span class="operator">(</span><span class="string">&#039;data structure&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">|</span><span class="operator">|</span><span class="operator"> </span><span class="variable">text</span><span class="operator">.</span><span class="function">includes</span><span class="operator">(</span><span class="string">&#039;json&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span></div>
            <div class="code-line"><span class="comment">run</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Purpose: Scans designated columns for JSON-like snippets matching the requested key and</span></div>
            <div class="code-line"><span class="comment">returns a summary report.</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Behavior: - Resolves the target key using extractKey and normalizes to lowercase</span></div>
            <div class="code-line"><span class="comment">comparisons - Confirms that the monitored columns exist within the CSV headers - Iterates</span></div>
            <div class="code-line"><span class="comment">over each row and column to capture JSON-like content containing braces or brackets -</span></div>
            <div class="code-line"><span class="comment">Filters snippets by the requested key when provided - Limits the output to digestible</span></div>
            <div class="code-line"><span class="comment">snippet previews and indicates when additional results exist</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Parameters: - context: { query: { json?: { key?: string, category?: string, type?: string }</span></div>
            <div class="code-line"><span class="comment">, text: string }, rows: unknown[][], headers: string[], row: unknown[], getPath: (row:</span></div>
            <div class="code-line"><span class="comment">unknown[]) =&gt; string, getValue: (row: unknown[], header: string) =&gt; { trim: () =&gt; string },</span></div>
            <div class="code-line"><span class="comment">buildRowPath: (row: unknown[]) =&gt; string }</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Returns: string providing a formatted summary of matching snippets</span></div>
            <div class="code-line">&nbsp;</div>
            <div class="code-line"><span class="comment">Key Features: - Context-aware filtering: Honors requested keys without ignoring general</span></div>
            <div class="code-line"><span class="comment">structure scans - Safe defaults: Handles missing columns and absent matches with</span></div>
            <div class="code-line"><span class="comment">actionable messaging - Readable output: Produces structured lines suited for CLI</span></div>
            <div class="code-line"><span class="comment">consumption</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="function">run</span><span class="operator">(</span><span class="variable">context</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Grab frequently used helpers and dataset references from the context.</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="operator">{</span><span class="operator"> </span><span class="variable">query</span><span class="operator">,</span><span class="operator"> </span><span class="variable">rows</span><span class="operator">,</span><span class="operator"> </span><span class="variable">headers</span><span class="operator">,</span><span class="operator"> </span><span class="variable">row</span><span class="operator">,</span><span class="operator"> </span><span class="variable">getPath</span><span class="operator">,</span><span class="operator"> </span><span class="variable">getValue</span><span class="operator"> </span><span class="operator">}</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="variable">context</span><span class="operator">;</span></div>
            <div class="code-line"><span class="comment">    Resolve the target key or category, comparing everything in lowercase to simplify</span></div>
            <div class="code-line"><span class="comment">    matching.</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">needle</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">extractKey</span><span class="operator">(</span><span class="variable">query</span><span class="operator">,</span><span class="operator"> </span><span class="function">getPath</span><span class="operator">(</span><span class="variable">row</span><span class="operator">)</span><span class="operator">)</span><span class="operator">.</span><span class="function">toLowerCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Build the lookup table linking monitored column names to their index positions.</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">columnIndices</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="type">STRUCTURE_COLUMNS</span><span class="operator">.</span><span class="function">map</span><span class="operator">(</span><span class="operator">(</span><span class="variable">name</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">(</span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">name</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">index</span><span class="operator">:</span><span class="operator"> </span><span class="variable">headers</span><span class="operator">.</span><span class="function">findIndex</span><span class="operator">(</span><span class="operator">(</span><span class="variable">header</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">header</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="function">toUpperCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="variable">name</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">)</span><span class="operator">.</span><span class="function">filter</span><span class="operator">(</span><span class="operator">(</span><span class="variable">entry</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="variable">entry</span><span class="operator">.</span><span class="variable">index</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">columnIndices</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="string">&#039;structure-finder: The target columns are missing from the CSV.&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">matches</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Inspect every row and monitored column for JSON-like snippets referencing the key.</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">rows</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">loopRow</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">columnIndices</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="operator">{</span><span class="operator"> </span><span class="variable">name</span><span class="operator">,</span><span class="operator"> </span><span class="variable">index</span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">value</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">(</span><span class="variable">loopRow</span><span class="operator">[</span><span class="variable">index</span><span class="operator">]</span><span class="operator"> </span><span class="operator">?</span><span class="operator">?</span><span class="operator"> </span><span class="string">&#039;&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">toString</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="operator">!</span><span class="variable">value</span><span class="operator">.</span><span class="function">includes</span><span class="operator">(</span><span class="string">&#039;{&#039;</span><span class="operator">)</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="operator">!</span><span class="variable">value</span><span class="operator">.</span><span class="function">includes</span><span class="operator">(</span><span class="string">&#039;[&#039;</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">needle</span><span class="operator"> </span><span class="operator">&amp;</span><span class="operator">&amp;</span><span class="operator"> </span><span class="operator">!</span><span class="variable">value</span><span class="operator">.</span><span class="function">toLowerCase</span><span class="operator">(</span><span class="operator">)</span><span class="operator">.</span><span class="function">includes</span><span class="operator">(</span><span class="variable">needle</span><span class="operator">)</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">matches</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">path</span><span class="operator">:</span><span class="operator"> </span><span class="variable">context</span><span class="operator">.</span><span class="function">buildRowPath</span><span class="operator">(</span><span class="variable">loopRow</span><span class="operator">)</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">column</span><span class="operator">:</span><span class="operator"> </span><span class="variable">name</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">snippet</span><span class="operator">:</span><span class="operator"> </span><span class="variable">value</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator"> </span><span class="number">160</span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="string">`${value.slice(0, 157)}...`</span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="variable">value</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">matches</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">0</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">needle</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="string">`structure-finder: No JSON-like snippets referencing &quot;${needle}&quot; were located.`</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="string">&#039;structure-finder: No JSON-like snippets were located in the monitored columns.&#039;</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="comment">Compose the human-readable report summarizing discovered snippets.</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">lines</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="operator">[</span><span class="operator">]</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">lines</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="string">`Structure scan${needle ? `</span><span class="operator"> </span><span class="keyword">for</span><span class="operator"> </span><span class="string">&quot;${needle}&quot;</span><span class="string">` : &#039;&#039;} (${matches.length} snippet${</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">matches</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">=</span><span class="operator">=</span><span class="operator">=</span><span class="operator"> </span><span class="number">1</span><span class="operator"> </span><span class="operator">?</span><span class="operator"> </span><span class="operator">&#039;</span><span class="operator">&#039;</span><span class="operator"> </span><span class="operator">:</span><span class="operator"> </span><span class="operator">&#039;</span><span class="variable">s</span><span class="operator">&#039;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">`</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">matches</span><span class="operator">.</span><span class="function">slice</span><span class="operator">(</span><span class="number">0</span><span class="operator">,</span><span class="operator"> </span><span class="number">6</span><span class="operator">)</span><span class="operator">.</span><span class="function">forEach</span><span class="operator">(</span><span class="operator">(</span><span class="variable">entry</span><span class="operator">)</span><span class="operator"> </span><span class="operator">=</span><span class="operator">&gt;</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">lines</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="operator">`</span><span class="operator">-</span><span class="operator"> </span><span class="operator">$</span><span class="operator">{</span><span class="variable">entry</span><span class="operator">.</span><span class="variable">path</span><span class="operator">}</span><span class="operator"> </span><span class="operator">(</span><span class="operator">$</span><span class="operator">{</span><span class="variable">entry</span><span class="operator">.</span><span class="variable">column</span><span class="operator">}</span><span class="operator">)</span><span class="operator">`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">lines</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="operator">`</span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">$</span><span class="operator">{</span><span class="variable">entry</span><span class="operator">.</span><span class="variable">snippet</span><span class="operator">}</span><span class="operator">`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">matches</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">&gt;</span><span class="operator"> </span><span class="number">6</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">lines</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="operator">`</span><span class="operator">-</span><span class="operator"> </span><span class="operator">.</span><span class="operator">.</span><span class="operator">.</span><span class="operator"> </span><span class="operator">+</span><span class="operator">$</span><span class="operator">{</span><span class="variable">matches</span><span class="operator">.</span><span class="variable">length</span><span class="operator"> </span><span class="operator">-</span><span class="operator"> </span><span class="number">6</span><span class="operator">}</span><span class="operator"> </span><span class="variable">additional</span><span class="operator"> </span><span class="function">snippet</span><span class="operator">(</span><span class="variable">s</span><span class="operator">)</span><span class="operator">`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">const</span><span class="operator"> </span><span class="variable">rowSummary</span><span class="operator"> </span><span class="operator">=</span><span class="operator"> </span><span class="function">getValue</span><span class="operator">(</span><span class="variable">row</span><span class="operator">,</span><span class="operator"> </span><span class="operator">&#039;</span><span class="type">SUMMARY</span><span class="operator">&#039;</span><span class="operator">)</span><span class="operator">.</span><span class="function">trim</span><span class="operator">(</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">if</span><span class="operator"> </span><span class="operator">(</span><span class="variable">rowSummary</span><span class="operator">)</span><span class="operator"> </span><span class="operator">{</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">/</span><span class="operator">/</span><span class="operator"> </span><span class="type">Surface</span><span class="operator"> </span><span class="variable">the</span><span class="operator"> </span><span class="variable">active</span><span class="operator"> </span><span class="variable">row</span><span class="operator">&#039;</span><span class="variable">s</span><span class="operator"> </span><span class="variable">summary</span><span class="operator"> </span><span class="keyword">for</span><span class="operator"> </span><span class="variable">quick</span><span class="operator"> </span><span class="variable">context</span><span class="operator">.</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">lines</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="operator">&#039;</span><span class="operator">&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="variable">lines</span><span class="operator">.</span><span class="function">push</span><span class="operator">(</span><span class="operator">`</span><span class="type">Row</span><span class="operator"> </span><span class="variable">summary</span><span class="operator">:</span><span class="operator"> </span><span class="operator">$</span><span class="operator">{</span><span class="variable">rowSummary</span><span class="operator">}</span><span class="operator">`</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span></div>
            <div class="code-line"></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="operator"> </span><span class="keyword">return</span><span class="operator"> </span><span class="variable">lines</span><span class="operator">.</span><span class="function">join</span><span class="operator">(</span><span class="operator">&#039;</span><span class="operator">\</span><span class="variable">n</span><span class="operator">&#039;</span><span class="operator">)</span><span class="operator">;</span></div>
            <div class="code-line"><span class="operator"> </span><span class="operator"> </span><span class="operator">}</span><span class="operator">,</span></div>
            <div class="code-line"><span class="operator">}</span><span class="operator">;</span></div>
            <div class="code-line"></div>
        </div>
    </div>
</body>
</html>